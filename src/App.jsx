import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';
import { Play, RotateCcw, CheckCircle, XCircle, Trophy, Settings, BookOpen, Shuffle, ListOrdered, Volume2, Edit2, Clock, Download, Layers, Eye, ThumbsUp, ThumbsDown, Library, Keyboard, Repeat, AlertCircle, Sparkles, Mic, MicOff, Activity } from 'lucide-react';

// ==========================================
// 1. データセット定義
// ==========================================

// --- データセット1: 英単語マスター 800 ---
const RAW_DATA_MASTER_800 = `1be〜である、いる、ある、存在する[ビー]
2become〜になる、成る[ビカム]
3go行く、いく[ゴー]
4come来る、くる[カム]
5doする、行う[ドゥ]
6play(スポーツなどを)する,遊ぶ,演奏する,弾く[プレイ]
7enjoy楽しむ、たのしむ[エンジョイ]
8open開ける 開いている、あける[オープン]
9close閉じる 親密な、近い、とじる、閉める、しめる[クローズ]
10ask尋ねる、頼む、たずねる、たのむ[アスク]
11answer答える、答え、こたえる[アンサー]
12stand立っている、立つ、たつ[スタンド]
13sit座っている、座る、すわる[シット]
14takeとる、〜に持って[連れていく]、取る[テイク]
15bring持っていく[連れていく]くる、もたらす[ブリング]
16give与える、出す、あげる[ギブ]
17practice練習する、れんしゅうする[プラクティス]
18study勉強する、研究する、べんきょうする[スタディ]
19learn学ぶ、習得する、まなぶ[ラーン]
20see見る、会う、みる、あう[シー]
21look見る、（形容詞を伴い）〜に見える、みる[ルック]
22watch見る 腕時計、みる、ウォッチ[ウォッチ]
23meet出会う、会う、であう、あう[ミート]
24hear聞く、聞こえる、きく、聴く[ヒア]
25listen聴く、聞く、きく[リスン]
26like好んでいる、〜のような、好き、すき[ライク]
27love愛している、大好きである、愛、あい[ラブ]
28have持っている、食べる、経験する、もっている[ハブ]
29hold（一時的に）持つ、保持する、開催する、もつ[ホールド]
30catchとらえる、つかむ、捕まえる、キャッチ[キャッチ]
31get得る、〜になる、手に入れる[ゲット]
32buy買う、かう[バイ]
33drink飲む、飲み物、のむ[ドリンク]
34eat食べる、たべる[イート]
35make作る、〜を…にする、つくる[メイク]
36cook料理する、作る、料理人、つくる[クック]
37say言う、いう[セイ]
38tell話す、伝える、はなす、つたえる[テル]
39speak話す、はなす[スピーク]
40talk話す、はなす[トーク]
41think思っている、考える、おもう、かんがえる[シンク]
42feel感じている、〜だと思う、〜の感じがする、感じる、かんじる[フィール]
43walk歩く、あるく[ウォーク]
44run走る、はしる[ラン]
45swim泳ぐ、およぐ[スイム]
46sing歌う、うたう[シング]
47wash洗う、あらう[ウォッシュ]
48cleanきれいにする、そうじする、きれいな、掃除する[クリーン]
49read読む、よむ[リード]
50write書く、かく[ライト]
51find見つける、〜とわかる、みつける[ファインド]
52put置く、おく[プット]
53know知っている、しっている[ノウ]
54thank感謝する[サンク]
55want欲している、ほしい、欲しい[ウォント]
56need必要としている、必要、ひつよう[ニード]
57help助ける、手伝う、助け、たすける、てつだう[ヘルプ]
58leave去る、残す、〜のままにする、さる、のこす[リーブ]
59try試す、努力する、ためす[トライ]
60work働く、仕事、作品、はたらく[ワーク]
61use使う、使用、使いみち、つかう[ユース]
62change変わる、変える、変化、つり銭、かわる、かえる[チェンジ]
63show見せる、案内する、みせる[ショウ]
64call呼ぶ、電話をかける、よぶ[コール]
65live住んでいる、生きている、すんでいる[リブ]
66visit訪問する、訪れる、おとずれる[ビジット]
67fly飛ぶ、飛ばす、とぶ[フライ]
68start始まる、始める、はじまる、はじめる[スタート]
69stop止まる、止める、やめる、とまる、とめる[ストップ]
70stayとどまる、滞在する、滞在[ステイ]
71beautiful美しい、心地よい、見事だ、うつくしい、綺麗、きれい[ビューティフル]
72prettyきれい、感じがいい、かわいい、かなり、綺麗、可愛い[プリティ]
73cuteかわいい、可愛い[キュート]
74big大きい、おおきい[ビッグ]
75large大きい、おおきい[ラージ]
76little小さな、かわいらしい、ちいさな[リトル]
77small小さい、ちいさい[スモール]
78cold寒い、冷たい、風邪、さむい、つめたい[コールド]
79cool涼しい、ほどよく冷たい、かっこいい、すずしい[クール]
80warm暖かい、温かい、あたたかい[ウォーム]
81hot暑い、熱い、辛い、あつい[ホット]
82high高い、高く、たかい[ハイ]
83low低い、低く、ひくい[ロウ]
84tall背の高い、高い、たかい[トール]
85long長い、ながい[ロング]
86short短い、不足している、みじかい[ショート]
87old古い、年をとった、〜歳（年）の、ふるい[オールド]
88new新しい、あたらしい[ニュー]
89young若い、わかい[ヤング]
90good良い、ためになること、よい、いい[グッド]
91great偉大な、すばらしい、大きな、凄い、すごい[グレイト]
92nice良い、よい、ナイス[ナイス]
93wonderfulすばらしい、驚嘆すべき、素晴らしい[ワンダフル]
94fine良い、（天気や体調などが）悪くない、よい、元気[ファイン]
95bad良くない、悪い、わるい[バッド]
96happy楽しい、幸福な、うれしい、幸運な、幸せ、しあわせ[ハッピー]
97gladうれしい、嬉しい[グラッド]
98sad悲しい、かなしい[サッド]
99sorry気の毒に思って、すまないと思って、残念に思って、ごめんなさい[ソーリー]
100dear親愛なる、愛する人[ディア]
101tired疲れている、飽きている、つかれた、疲れた[タイアード]
102hungryお腹がすいている、空腹、はらぺこ[ハングリー]
103thirstyのどが渇いている、喉が渇いた[サースティ]
104manyたくさんの、多くの、数多くの[メニー]
105muchたくさんの、多くの、多量の[マッチ]
106someいくらかの、ある〜[サム]
107right正しい、右の、正解、右、みぎ[ライト]
108wrong間違った、調子が悪い、間違い[ロング]
109busy忙しい、いそがしい[ビジー]
110free自由な、ひまな、無料の、じゆう[フリー]
111allすべての、全部、ぜんぶ[オール]
112everyどの〜も、毎〜、あらゆる[エブリ]
113anyどんな〜でも[エニー]
114next次の、来〜、となりの、つぎの[ネクスト]
115last最後の、この前の、さいごの[ラスト]
116white白い、しろい、白、しろ[ホワイト]
117black黒い、くろい、黒、くろ[ブラック]
118red赤い、あかい、赤、あか[レッド]
119blue青い、あおい、青、あお[ブルー]
120green緑色の、みどり、緑[グリーン]
121yellow黄色の、きいろ、黄色[イエロー]
122not〜ない[ノット]
123up上に［へ］、うえ[アップ]
124down下に［へ］、した[ダウン]
125out外に［へ・で］、そと[アウト]
126backうしろへ［に］、戻る、背中[バック]
127forward前方へ［に］、前へ[フォワード]
128hereここに［へ・で］、ここ[ヒア]
129thereそこに［へ・で］、そこ[ゼア]
130justちょうど、ただ[ジャスト]
131now今、いま[ナウ]
132ago〜前に、まえに[アゴー]
133thenその時、それから、そのとき[ゼン]
134today今日、きょう[トゥデイ]
135yesterdayきのう、昨日[イエスタデイ]
136tomorrowあす、将来、明日、あした[トゥモロー]
137tonight今夜、こんや[トゥナイト]
138laterあとで、より遅く、後で[レイター]
139a.m.午前、ごぜん[エーエム]
140p.m.午後、ごご[ピーエム]
141too～も（また）、～すぎる[トゥー]
142also～もまた（同様に）[オルソー]
143veryとても、非常に[ベリー]
144well上手に、よく／健康で[ウェル]
145hard一生懸命に、激しく、硬い、かたい[ハード]
146againふたたび、また、再び[アゲイン]
147alwaysいつも、常に[オールウェイズ]
148usuallyたいてい、ふつう、普通[ユージュアリー]
149oftenよく、たびたび、しばしば[オフン]
150sometimes時々、ときどき[サムタイムズ]
151homeわが家に、故郷に、家、いえ[ホーム]
152away離れて[アウェイ]
153outside外に（で・は）、外、そと[アウトサイド]
154almostほとんど[オールモスト]
155still依然として、まだ[スティル]
156really本当に、ほんとうに[リアリー]
157together一緒に、いっしょに[トゥギャザー]
158pleaseどうぞ／喜ばせる、お願いします[プリーズ]
159let’s～しよう[レッツ]
160early早く、早い、はやく、はやい[アーリー]
161late遅く、遅れて／遅い、おそく、おそい[レイト]
162a / an（不特定の）あるひとつの、〜ごとに[ア/アン]
163theその（訳さないことが多い）[ザ]
164I私は、わたし[アイ]
165youあなたは、あなたたちは[ユー]
166he彼は、かれ[ヒー]
167she彼女は、かのじょ[シー]
168we私たちは、わたしたち[ウィー]
169they彼らは、彼女らは、それらは[ゼイ]
170itそれは[イット]
171thisこれは、この、これを[ディス]
172thatあれは、それは、あの、あれを[ザット]
173theseこれらは（の・を）[ディーズ]
174thoseあれらは（の・を）、それらは（の・を）[ゾーズ]
175what何、どんなもの（こと）、何の、どんな、なに[ワット]
176whoだれ、誰[フー]
177whoseだれの（もの）、誰の[フーズ]
178whichどれ、どちら、どの、どちらの[ウィッチ]
179whenいつ[ウェン]
180whereどこ[ウェア]
181whyなぜ、なんで[ホワイ]
182howどのように、どう、どれくらい[ハウ]
183at～で［に］、～めがけて[アット]
184in～（の中）に［で］、中、なか[イン]
185for～に向けて、～のために、～の間[フォー]
186to～へ［に］、～まで[トゥー]
187on～（の上）に、～に（曜日や日付）、上、うえ[オン]
188off～から離れて、オフ[オフ]
189of～（の中で）の、～について[オブ]
190with～と（一緒に）、～を持って[ウィズ]
191from～から、～で[フロム]
192by～のそばに、～までに、～で、～によって[バイ]
193near～の近くに、ちかく[ニア]
194after～のあとに、～したあとで、後、あと[アフター]
195before～の前に、～する前に、前、まえ[ビフォー]
196over～の真上に、～を越えて[オーバー]
197under～の下に、～未満、下、した[アンダー]
198about～について、～のあたりに、約[アバウト]
199around～の周りに、～のあたりに、約、まわり[アラウンド]
200family家族、かぞく[ファミリー]
201parent親、おや[ペアレント]
202father父、ちち、お父さん[ファーザー]
203mother母、はは、お母さん[マザー]
204brother兄弟、きょうだい、兄、弟[ブラザー]
205sister姉妹、しまい、姉、妹[シスター]
206son息子、むすこ[サン]
207daughter娘、むすめ[ドーター]
208grandfather祖父、おじいさん[グランドファーザー]
209grandmother祖母、おばあさん[グランドマザー]
210uncleおじ、叔父、伯父[アンクル]
211auntおば、叔母、伯母[アント]
212cousinいとこ、従兄弟[カズン]
213child子ども、こども[チャイルド]
214kid子ども(childのくだけた表現)、こども、キッズ[キッド]
215house家、いえ[ハウス]
216bath入浴、浴室、お風呂、ふろ[バス]
217bedベッド、寝台[ベッド]
218doorドア、玄関、1軒、扉、とびら[ドア]
219floor床、（建物の）階、ゆか[フロア]
220room部屋、空間、余地、へや[ルーム]
221window窓、まど[ウィンドウ]
222wall壁、塀、かべ[ウォール]
223garden庭園、菜園、庭、にわ[ガーデン]
224desk机、つくえ[デスク]
225tableテーブル、表[テーブル]
226chairいす、椅子[チェア]
227TVテレビ[ティービー]
228program番組、計画、プログラム[プログラム]
229telephone電話、でんわ[テレフォン]
230videoビデオ、映像[ビデオ]
231CDCD、シーディー[シーディー]
232computerコンピューター、PC[コンピュータ]
233Internetインターネット[インターネット]
234e-mail電子メール、メール[イーメール]
235letter手紙、文字、てがみ[レター]
236clock掛け時計、置き時計、時計、とけい[クロック]
237light明かり、光、（色が）薄い、ライト、ひかり[ライト]
238body体、からだ[ボディ]
239head頭、あたま[ヘッド]
240face顔、直面する、かお[フェイス]
241eye目、め[アイ]
242mouth口、くち[マウス]
243hair髪、かみ[ヘア]
244hand手、て[ハンド]
245leg脚、あし[レッグ]
246school学校、がっこう[スクール]
247subject教科、主題、主語、科目[サブジェクト]
248art芸術、美術、アート[アート]
249history歴史、れきし[ヒストリー]
250music音楽、おんがく[ミュージック]
251English英語、えいご[イングリッシュ]
252classクラス、授業、学級、じゅぎょう[クラス]
253clubクラブ、部活[クラブ]
254groupグループ、集団[グループ]
255teamチーム[チーム]
256fanファン、扇風機[ファン]
257homework宿題、しゅくだい[ホームワーク]
258teacher先生、せんせい、教師[ティーチャー]
259Mr.（男性に対して）〜さん、〜様、〜先生[ミスター]
260Ms.（女性に対して）〜さん、〜様、〜先生[ミズ]
261student学生、がくせい、生徒[ステューデント]
262friend友だち、友人、ともだち、友達[フレンド]
263everyoneだれも皆、みんな[エブリワン]
264gym体育館、ジム[ジム]
265groundグラウンド、用地、地面[グラウンド]
266test試験、検査、テスト[テスト]
267number数、数字、番号、ナンバー[ナンバー]
268picture絵、写真、え、しゃしん[ピクチャー]
269sign標識、符号、合図、身ぶり、署名、サイン[サイン]
270color色、いろ[カラー]
271word単語、ことば、言葉[ワード]
272dictionary辞書、辞典、じしょ[ディクショナリー]
273book本、（動）予約する、ほん[ブック]
274notebookノート、手帳[ノートブック]
275penペン[ペン]
276eraser消しゴム、黒板ふき、けしごむ[イレイサー]
277bagカバン、袋、バッグ[バッグ]
278event出来事、行事、催し物、試合、イベント[イベント]
279festival祭り、〜祭、まつり[フェスティバル]
280sportスポーツ[スポーツ]
281game試合、遊び、ゲーム[ゲーム]
282player選手、競技者、演奏者、プレイヤー[プレイヤー]
283racketラケット[ラケット]
284animal動物、どうぶつ[アニマル]
285bird鳥、とり[バード]
286fish魚、魚釣りをする、さかな[フィッシュ]
287petペット[ペット]
288flower花、はな[フラワー]
289tree木、き[ツリー]
290fruitくだもの、果実、フルーツ[フルーツ]
291year年、〜歳、とし[イヤー]
292season季節、時期、きせつ[シーズン]
293month月、つき[マンス]
294week週、しゅう[ウィーク]
295day日、日中、ひ[デイ]
296date日付、デート、ひづけ[デイト]
297morning朝、午前、あさ[モーニング]
298noon正午、昼、ひる[ヌーン]
299afternoon午後、ごご[アフタヌーン]
300evening夕方、晩、ゆうがた[イブニング]
301night夜、よる[ナイト]
302time時、時間、〜回、〜度、〜倍、とき、じかん[タイム]
303hour時間、じかん[アワー]
304minute分、ふん[ミニット]
305January 1月、いちがつ[ジャニュアリー]
306February 2月、にがつ[フェブラリー]
307March 3月、さんがつ[マーチ]
308April 4月、しがつ[エイプリル]
309May 5月、ごがつ[メイ]
310June 6月、ろくがつ[ジューン]
311July 7月、しちがつ[ジュライ]
312August 8月、はちがつ[オーガスト]
313September 9月、くがつ[セプテンバー]
314October 10月、じゅうがつ[オクトーバー]
315November 11月、じゅういちがつ[ノーベンバー]
316December 12月、じゅうにがつ[ディセンバー]
317Sunday日曜日、にちようび[サンデー]
318Monday月曜日、げつようび[マンデー]
319Tuesday火曜日、かようび[チューズデー]
320Wednesday水曜日、すいようび[ウェンズデー]
321Thursday木曜日、もくようび[サーズデー]
322Friday金曜日、きんようび[フライデー]
323Saturday土曜日、どようび[サタデー]
324spring春、はる[スプリング]
325summer夏、なつ[サマー]
326fall秋、あき、落ちる[フォール]
327winter冬、ふゆ[ウィンター]
328people人々、ひとびと[ピープル]
329man男性、人間、男、おとこ[マン]
330woman女性、女、おんな[ウーマン]
331boy少年、男の子[ボーイ]
332girl少女、女の子[ガール]
333food食べ物、たべもの、フード[フード]
334cooking料理、りょうり、クッキング[クッキング]
335breakfast朝食、あさごはん[ブレックファスト]
336lunch昼食、ひるごはん、ランチ[ランチ]
337dinner夕食、主要な食事、ゆうごはん、ディナー[ディナー]
338curryカレー料理、カレー[カレー]
339rice米、ごはん、こめ、ライス[ライス]
340breadパン[ブレッド]
341egg卵、たまご[エッグ]
342cakeケーキ[ケーキ]
343tea紅茶、お茶[ティー]
344juiceジュース、汁[ジュース]
345milkミルク、牛乳、ぎゅうにゅう[ミルク]
346water水、（動）水をやる、みず[ウォーター]
347cupカップ[カップ]
348glassコップ、グラス、ガラス[グラス]
349dish皿、料理、さら[ディッシュ]
350place場所、ばしょ[プレイス]
351library図書館、図書室、としょかん[ライブラリー]
352park公園、駐車場、（動）駐車する、こうえん[パーク]
353restaurantレストラン[レストラン]
354zoo動物園、どうぶつえん[ズー]
355car自動車、車、くるま[カー]
356busバス[バス]
357train列車、（動）訓練する、電車、でんしゃ[トレイン]
358moneyお金、かね[マネー]
359dollarドル[ダラー]
360begin始まる、始める、はじまる、はじめる[ビギン]
361finish終わる、終える、おわる、おえる[フィニッシュ]
362keep保つ、持ち続ける、～のままでいる、たもつ[キープ]
363borrow借りる、かりる[ボロウ]
364lend貸す、かす[レンド]
365wear着ている、身につけている、きる[ウェア]
366remember覚えている、思い出す、おぼえている、おもいだす[リメンバー]
367forget忘れる、わすれる[フォゲット]
368breakこわす、こわれる、休憩、壊す[ブレイク]
369build建てる、たてる[ビルド]
370arrive着く、つく、到着する[アライブ]
371reach着く、届く、達する、つく、とどく[リーチ]
372ride乗る、のる[ライド]
373save救う、蓄える、節約する、すくう、ためる[セーブ]
374rise上がる、昇る、あがる、のぼる[ライズ]
375raise上げる、あげる、育てる[レイズ]
376touch触れる、接触、手触り、さわる、タッチ[タッチ]
377move動かす、動く、うごかす、うごく[ムーブ]
378carry運ぶ、はこぶ[キャリー]
379hit打つ、うつ、ヒット[ヒット]
380set置く、定める、沈む、セットする[セット]
381wish願う、願い、ねがう[ウィッシュ]
382hope望む、〜だとよいと思う、のぞむ、希望[ホープ]
383miss乗り遅れる、逃す、〜がなくてさびしく思う、ミス[ミス]
384worry心配する、しんぱいする[ウォーリー]
385excuse大目に見る、許す、言い訳[エクスキューズ]
386agree同意する、賛成する[アグリー]
387wait待つ、まつ[ウェイト]
388followあとについていく、従う、したがう[フォロー]
389lose失う、負ける、うしなう、まける[ルーズ]
390sell売る、売れる、うる[セル]
391throw投げる、なげる[スロウ]
392turn回す、曲がる、順番、まわす、まがる[ターン]
393return戻る、帰る、戻す、返す、もどる、かえる[リターン]
394pass回す、経過する、合格する、通る、とおる[パス]
395collect集める、あつめる[コレクト]
396join加わる、参加する、参加[ジョイン]
397send送る、おくる[センド]
398travel旅行する、りょこうする[トラベル]
399cut切る、きる、カット[カット]
400spend（お金や時間を）ついやす、使う、費やす、すごす、過ごす[スペンド]
401grow成長する、栽培する、そだつ、育てる[グロウ]
402die死ぬ、枯れる、しぬ[ダイ]
403cry叫ぶ、泣く、さけぶ、なく[クライ]
404sleep眠る、眠り、ねむる、寝る[スリープ]
405dance踊る、踊り、おどる、ダンス[ダンス]
406teach教える、おしえる[ティーチ]
407understand理解する、わかる、分かった[アンダースタンド]
408win勝つ、勝ちとる、かつ[ウィン]
409mean意味する、意図する、〜のつもりである、いみする[ミーン]
410sound～のように聞こえる、音、おと[サウンド]
411smileほほ笑む、ほほ笑み、笑う、わらう[スマイル]
412laugh笑う、わらう[ラフ]
413pay払う、はらう、支払う[ペイ]
414drive運転する、うんてんする、ドライブ[ドライブ]
415ring鳴る、鳴りひびく、鳴らす、指輪、輪、なる、ゆびわ[リング]
416land着陸する、上陸する、陸、土地、とち[ランド]
417pick選ぶ、摘む、つつく、えらぶ、拾う[ピック]
418seem～のように思われる、～らしい[シーム]
419mind気にする、かまう、いやだと思う、思い、精神、心[マインド]
420rich金持ちの、豊かな、ゆたかな[リッチ]
421poor貧しい、乏しい、へたな、かわいそうな、まずしい[プア]
422strong強い、つよい[ストロング]
423weak弱い、よわい[ウィーク]
424same同じ、同じもの（こと）、おなじ[セイム]
425different異なっている、違う、ちがう[ディファレント]
426easy簡単な、気楽な、かんたん、やさしい[イージー]
427difficult難しい、むずかしい[ディフィカルト]
428otherほかの／ほかの人・もの、他の[アザー]
429anotherもうひとつの／もうひとつの人・もの、別の[アナザー]
430both両方の／両方とも、両方、りょうほう[ボース]
431eachおのおのの／おのおの・各自、それぞれ[イーチ]
432half半分の／半分、はんぶん[ハーフ]
433fullいっぱいの、満タン[フル]
434onlyただひとつの／ただ～だけ、唯一[オンリー]
435betterより優れた／もっと、より良い[ベター]
436best最も優れた／一番、ベスト、最高、さいこう[ベスト]
437moreより多くの／もっと[モア]
438most最も多くの／ほとんどの、最も、もっとも[モスト]
439important重要な／大切な、じゅうよう、たいせつ[インポータント]
440useful役に立つ、便利、べんり[ユースフル]
441careful注意深い、気をつける[ケアフル]
442popular人気がある、にんき[ポピュラー]
443deliciousとてもおいしい、美味しい[デリシャス]
444famous有名な、ゆうめい[フェイマス]
445dangerous危険な／危ない、きけん、あぶない[デンジャラス]
446safe安全な／差し支えない、あんぜん[セーフ]
447interested興味を抱いている／興味がある、きょうみがある[インタレスティッド]
448interesting興味を抱かせる／興味深い、面白い、おもしろい[インタレスティング]
449excited興奮している／わくわくしている[エキサイテッド]
450exciting興奮させる／わくわくさせる[エキサイティング]
451surprised驚いている、おどろいた[サプライズド]
452amazing驚くべき、すばらしい、すごい[アメイジング]
453angry怒っている、おこっている[アングリー]
454sleepy眠たい、ねむい[スリーピー]
455lucky運がいい／ついている、ラッキー[ラッキー]
456friendly友好的な／親しみやすい、フレンドリー[フレンドリー]
457kind親切な、しんせつ、種類[カインド]
458sweet甘い／甘いお菓子（複数形で）、あまい[スイート]
459afraid恐れて／こわがって、怖い、こわい[アフレイド]
460favorite一番好きな／お気に入りの／お気に入りのもの・人[フェイバリット]
461sure確信して／確実な／もちろん[シュア]
462sick病気の／吐き気がする、病気[シック]
463quiet静かな／平穏な、しずか[クワイエット]
464special特別な、とくべつ[スペシャル]
465own自分自身の／独自の／所有する、自分の[オウン]
466loud（声や音が）大きな／大声で、うるさい[ラウド]
467ready準備ができている／用意ができている、準備、じゅんび[レディ]
468comicマンガの／喜劇の／マンガの本、漫画[コミック]
469fast速い／速く、はやい[ファスト]
470soonまもなく／早めに、すぐに[スーン]
471quicklyすばやく／すぐに、速く、はやく[クイックリー]
472maybeもしかすると、たぶん[メイビー]
473probablyきっと（70〜80%の確率で）、おそらく[プロバブリー]
474finallyついに／最後に、とうとう[ファイナリー]
475once1度／1回／かつて、一度、一回[ワンス]
476twice2度／2回／2倍、二度、二回[トゥワイス]
477never一度も〜ない／決して〜ない[ネバー]
478everこれまでに[エバー]
479yetまだ（〜ない）／もう（〜しましたか）[イエット]
480alreadyすでに（肯定文で）／もう[オールレディ]
481even～でさえも／（形）対等の[イーブン]
482as同じくらい、〜として[アズ]
483abroad外国へ［で］、海外、かいがい[アブロード]
484elseその他に、ほか[エルス]
485far遠く（に）／はるかに／（形）遠い、とおい[ファー]
486straightまっすぐに／（形）まっすぐな[ストレイト]
487especially特に、とくに[エスペシャリー]
488actually実際に（は）／実は、じつは[アクチュアリー]
489suddenly突然に、突然、とつぜん[サドンリー]
490can（しようと思えば）〜できる／〜でありえる、できる[キャン]
491couldcanの過去形／〜できた（思考・認知などについて）、できた[クッド]
492will〜します／（きっと）〜だろう[ウィル]
493wouldwillの過去形／〜でしょうか？（丁寧な依頼）[ウッド]
494must〜しなければならない／〜に違いない[マスト]
495may〜してよろしい／〜かもしれない[メイ]
496should〜したほうがいい／〜のはずだ[シュッド]
497shall（〜しましょうか？）〜しませんか？／〜しましょうか？[シャル]
498and〜と／そして／それで／（命令文のあとで）そうすれば[アンド]
499or〜か／それとも／さもないと[オア]
500butしかし／でも／〜を除いて[バット]
501soそれで／だから／非常に／そんなに／そう[ソー]
502howeverしかしながら[ハウエバー]
503when〜するとき（に）／〜すると／〜したら、いつ[ウェン]
504if（もし）〜なら／〜したら／〜かどうか、もし[イフ]
505because（なぜなら）〜なので／〜だから[ビコーズ]
506while〜の間（に）／〜だが／一方で[ホワイル]
507although / though〜だが／〜だけれども[オーゾー]
508than〜よりも／〜と比べて[ザン]
509that（接続詞）〜ということ[ザット]
510across〜を横切って[アクロス]
511through〜を通り抜けて、〜を通して[スルー]
512against〜に（反）対して[アゲインスト]
513along〜に沿って／（副詞）どんどん先へ[アロング]
514between（2つのもの）の間に、あいだ[ビトウィーン]
515among（3つ以上のもの）の間に、なか[アマング]
516behind〜の背後に／〜のうしろに、後ろ[ビハインド]
517during〜の間ずっと／〜の間に[デューリング]
518into〜の中に［へ］[イントゥー]
519past〜を過ぎて、過去[パスト]
520since〜から／〜して以来／〜なので、以来[シンス]
521until / till〜までずっと／〜するまでずっと[アンティル]
522without〜なしで[ウィズアウト]
523above〜の上（のほう）に[アバブ]
524below〜の下（のほう）に[ビロウ]
525nature自然／性質／本質、しぜん[ネイチャー]
526world世界／世の中、せかい[ワールド]
527country国／田舎、くに[カントリー]
528field野原／畑／競技場／分野、フィールド[フィールド]
529hill丘／小山、おか[ヒル]
530rock岩、いわ、ロック[ロック]
531river川、かわ[リバー]
532sky空、そら[スカイ]
533sea海、うみ[シー]
534lake湖、みずうみ[レイク]
535earth地球／大地、ちきゅう[アース]
536moon月、つき[ムーン]
537star星／スター、ほし[スター]
538mountain山、やま[マウンテン]
539island島、しま[アイランド]
540weather天気、てんき[ウェザー]
541sun太陽／日光、たいよう[サン]
542rain雨／雨が降る、あめ[レイン]
543snow雪／雪が降る、ゆき[スノウ]
544cloud雲、くも[クラウド]
545wind風（大風を含む）、かぜ[ウィンド]
546city都市／市、まち[シティ]
547town町、まち[タウン]
548village村、むら[ビレッジ]
549building建物、たてもの、ビル[ビルディング]
550shopping買い物、かいもの[ショッピング]
551shop店、みせ[ショップ]
552movie映画、えいが[ムービー]
553concertコンサート[コンサート]
554hallホール／会館／（大）広間[ホール]
555seat座席／着席させる、席、せき[シート]
556museum博物館／美術館、はくぶつかん、びじゅつかん[ミュージアム]
557station駅／署／局、えき[ステーション]
558street街路／通り、道、みち[ストリート]
559tower塔、タワー[タワー]
560hospital病院、びょういん[ホスピタル]
561post office郵便局、ゆうびんきょく[ポストオフィス]
562bridge橋、はし[ブリッジ]
563castle城、しろ[キャッスル]
564temple寺／寺院、てら[テンプル]
565person人、ひと[パーソン]
566name名前／名づける、なまえ[ネーム]
567age年齢／時代、とし、ねんれい[エイジ]
568job仕事、しごと[ジョブ]
569birthday誕生日、たんじょうび[バースデー]
570baby赤ちゃん、あかちゃん[ベイビー]
571wife妻、つま[ワイフ]
572husband夫、おっと[ハズバンド]
573doctor医者、博士、いしゃ[ドクター]
574nurse看護師、かんごし[ナース]
575patient患者、かんじゃ[ペイシェント]
576scientist科学者、かがくしゃ[サイエンティスト]
577engineer技術者、エンジニア[エンジニア]
578musician音楽家、ミュージシャン[ミュージシャン]
579farmer農家、のうか[ファーマー]
580host主人（役）、主催者、ホスト[ホスト]
581hero英雄、主人公、ヒーロー[ヒーロー]
582line線、列、行、ライン[ライン]
583point点、要点、指をさす、ポイント[ポイント]
584top頂上、トップ[トップ]
585side側、側面、サイド[サイド]
586front前部、正面、前の、正面の、フロント[フロント]
587part部分、役割、パート[パート]
588piece1片、1個、1枚、ピース[ピース]
589north北、北の、北に［へ］、きた[ノース]
590south南、南の、南に［へ］、みなみ[サウス]
591east東、東の、東に［へ］、ひがし[イースト]
592west西、西の、西に［へ］、にし[ウエスト]
593left左、左の、左に［へ］、ひだり[レフト]
594right右、右の、右に［へ］、みぎ、正しい[ライト]
595thingもの、こと[シング]
596something何か、あるもの［こと］、なにか[サムシング]
597everythingどれも皆（すべてのもの、すべてのこと）、すべて[エブリシング]
598anything何か、何も（〜ない）、何でも[エニシング]
599nothing何も〜ない[ナッシング]
600life生命、生活、人生、いのち[ライフ]
601partyパーティー、一団[パーティー]
602song歌、うた[ソング]
603presentプレゼント、贈る、提示する、提供する、贈り物[プレゼント]
604cameraカメラ[カメラ]
605cardカード、トランプ[カード]
606message伝言、メッセージ[メッセージ]
607diary日記、にっき[ダイアリー]
608box箱、はこ[ボックス]
609paper紙、かみ[ペーパー]
610wood木材、き[ウッド]
611fire火、火事、解雇する、ひ[ファイア]
612meat肉、にく[ミート]
613tooth歯、は[トゥース]
614chopsticks箸、はし[チョップスティックス]
615bottleびん、ボトル[ボトル]
616clothes衣服、服、ふく[クローズ]
617uniformユニフォーム、制服、せいふく[ユニフォーム]
618rule規則、支配、ルール[ルール]
619courseコース、進路、課程[コース]
620way道、方向、方法、みち、ほうほう[ウェイ]
621lotたくさん、多数、多量[ロット]
622robotロボット[ロボット]
623bike自転車、バイク[バイク]
624boatボート、船[ボート]
625plane飛行機、ひこうき[プレーン]
626fun楽しみ、楽しいこと、たのしみ[ファン]
627question質問、問題、しつもん[クエスチョン]
628idea考え、案、思いつき、アイデア[アイデア]
629wake目が覚める、目を覚ます、おきる[ウェイク]
630shout大声で叫ぶ、さけぶ[シャウト]
631lie横になる、うそをつく、嘘[ライ]
632marry〜と結婚する、けっこん[マリー]
633happen（偶然に）起こる、おこる[ハプン]
634surprise驚かせる、驚き[サプライズ]
635impress感銘を与える、印象づける、感動[インプレス]
636cheer元気づける、応援する[チアー]
637encourage勇気づける、励ます[エンカレッジ]
638hurt傷つける、痛む、いたむ[ハート]
639push押す、おす[プッシュ]
640hide隠す、隠れる、かくす[ハイド]
641guide案内する、案内人、ガイド[ガイド]
642believe信じている、〜と思う、信じる、しんじる[ビリーブ]
643realize悟る、実現する、気づく[リアライズ]
644guess（当て推量で）言い当てる、推測する[ゲス]
645imagine想像する、そうぞうする[イマジン]
646express表現する、ひょうげんする[エクスプレス]
647wonder〜かしらと思う、不思議に思う[ワンダー]
648expect期待する、予期する、きたいする[エクスペクト]
649respect尊敬する、尊重する、そんけいする[リスペクト]
650decide決める、決心する、きめる[ディサイド]
651relaxくつろぐ、ゆるめる、リラックス[リラックス]
652fight戦う、名：戦い、たたかう[ファイト]
653notice気づく、名：通知、掲示、きづく[ノーティス]
654discover発見する、はっけんする[ディスカバー]
655produce生産する、産出する、せいさんする[プロデュース]
656reduce減らす、へらす[リデュース]
657introduce紹介する、しょうかいする[イントロデュース]
658reuse再利用する[リユース]
659recycle再生利用する、リサイクル[リサイクル]
660waste無駄にする、無駄に使う、名：廃物、廃棄物、むだ[ウェイスト]
661develop発展する、発展させる、開発する、かいはつ[ディベロップ]
662protect保護する、まもる、守る[プロテクト]
663steal盗む、ぬすむ[スティール]
664exchange交換する、こうかんする[エクスチェンジ]
665communicate伝達する、意思を通わせる、コミュニケーション[コミュニケート]
666explain説明する、せつめいする[エクスプレイン]
667invite招く、招待する[インバイト]
668smell～なにおいがする、名：におい[スメル]
669choose選ぶ、えらぶ[チューズ]
670climb登る、のぼる[クライム]
671continue続ける、つづける[コンティニュー]
672tie結ぶ、（複数形で）絆、むすぶ[タイ]
673enter入る、はいる、入学[エンター]
674kill殺す、ころす[キル]
675drop落ちる、落とす、名：しずく、おちる[ドロップ]
676serve（食事を）出す、仕える[サーブ]
677receive受けとる、受け取る、うけとる[レシーブ]
678solve解く、解決する、とく[ソルブ]
679report報告する、報道する、名：報告（書）、レポート[レポート]
680appear現れる、あらわれる[アピア]
681support支える、養う、支持する、サポート[サポート]
682cost（費用が）かかる、名：費用、コスト[コスト]
683add加える、くわえる、足す[アッド]
684prepare準備する、じゅんびする[プリペア]
685hurry急ぐ、急がせる、名：急ぎ、いそぐ[ハリー]
686promise約束する、名：約束、やくそく[プロミス]
687fill満たす、いっぱいにする[フィル]
688share分け合う、共有する、名：分け前、シェア[シェア]
689shy内気な、恥ずかしがりの、シャイ[シャイ]
690nervous神経質な、緊張[ナーバス]
691able〜できる、可能な[エイブル]
692proud誇りに思っている、自慢に思っている、誇り[プラウド]
693dying死にかけている、瀕死の[ダイイング]
694dead死んでいる、死[デッド]
695healthy健康な、健康に良い、けんこう[ヘルシー]
696international国際的な、こくさい[インターナショナル]
697foreign外国の、がいこく[フォーリン]
698traditional伝統的な、でんとう[トラディショナル]
699local地元の、その土地の、ローカル[ローカル]
700strange奇妙な、見知らぬ、変な[ストレンジ]
701real本当の、本物の、心からの、現実の、リアル[リアル]
702true真実の、本当、ほんとう[トゥルー]
703serious本気である、まじめな、重大な、深刻な、シリアス[シリアス]
704perfect完全な、完璧な、パーフェクト[パーフェクト]
705possible可能な、ありえる、起こりえる[ポッシブル]
706human人間の、人間らしい、にんげん[ヒューマン]
707natural自然の、当然の、ナチュラル[ナチュラル]
708wild野生の、ワイルド[ワイルド]
709plasticプラスチック製の、ビニール製の[プラスチック]
710softやわらかい、おだやかな、ソフト[ソフト]
711heavy重い、おもい[ヘビー]
712round丸い、まるい[ラウンド]
713simple簡単な、単純な、質素な、シンプル[シンプル]
714necessary必要な、ひつよう[ネセサリー]
715funnyおかしな、こっけいな、変わった、面白い[ファニー]
716terribleひどい、ものすごい、恐ろしい[テリブル]
717deep深い、ふかい[ディープ]
718dry乾いた、乾く、乾かす、ドライ[ドライ]
719public公の、公共の、公立の、大衆の、公衆の[パブリック]
720dark暗い、暗がり、くらい[ダーク]
721wide幅広い、広い、ひろい[ワイド]
722expensive高価な、高い、たかい[エクスペンシブ]
723cheap安い、やすい[チープ]
724suchそのような、そんなに、こんなに、あんなに[サッチ]
725few（数が）少ない、すくない[フュー]
726severalいくつかの、いく人かの[セベラル]
727whole全体の、全体、ぜんたい[ホール]
728enough十分な、じゅうぶん[イナフ]
729feeling感情、感覚、気持ち、きもち[フィーリング]
730experience経験、けいけん[エクスペリエンス]
731memory記憶、記念、思い出、メモリー[メモリー]
732interest興味、関心／興味をいだかせる、きょうみ[インタレスト]
733dream夢／夢を見る、ゆめ[ドリーム]
734interview会見、面接／会見する、面接する、インタビュー[インタビュー]
735opinion意見、いけん[オピニオン]
736skill技能、技術、スキル[スキル]
737power能力、力、権力、パワー、ちから[パワー]
738information情報、じょうほう[インフォメーション]
739communication意思疎通、伝達、通信、コミュニケーション[コミュニケーション]
740chance機会、チャンス[チャンス]
741language言語、げんご、ことば[ランゲージ]
742speech演説、スピーチ[スピーチ]
743plan計画／計画する、プラン[プラン]
744future将来、未来、みらい[フューチャー]
745newsニュース、知らせ[ニュース]
746fact事実、じじつ[ファクト]
747shape形、姿、状態、かたち[シェイプ]
748care世話、注意、気にする、ケア[ケア]
749rest休息、休養、休む、やすみ[レスト]
750attention注意、配慮、ちゅうい[アテンション]
751effort努力、どりょく[エフォート]
752luck運、幸運、ラック[ラック]
753health健康、けんこう[ヘルス]
754trouble困難、悩ます、トラブル[トラブル]
755headache頭痛、ずつう[ヘッドエイク]
756medicine薬、医学、くすり[メディスン]
757temperature温度、おんど、気温[テンパチャー]
758plant植物、工場、植える、しょくぶつ[プラント]
759vegetable野菜、やさい[ベジタブル]
760order注文、命令、順序、依頼、注文する、命令する、オーダー[オーダー]
761designデザイン、設計、設計する[デザイン]
762college大学、だいがく[カレッジ]
763tournamentトーナメント、試合[トーナメント]
764electricity電気、でんき[エレクトリシティ]
765convenience便利、都合、便利なもの〔こと〕[コンビニエンス]
766example例、れい[エグザンプル]
767view眺め、視界、考え（方）、景色[ビュー]
768reason理由、理性、りゆう[リーズン]
769activity活動、アクティビティ[アクティビティ]
770volunteerボランティア、志願者[ボランティア]
771period期間、時代、きかん[ピリオド]
772century世紀、せいき[センチュリー]
773society社会、しゃかい[ソサエティ]
774community地域社会、共同体、コミュニティ[コミュニティ]
775culture文化、ぶんか[カルチャー]
776custom（社会の）慣習、習慣[カスタム]
777population人口、（特定地域の）住民、じんこう[ポピュレーション]
778amount総計、量、りょう[アマウント]
779vacation休暇、休み、バケーション[バケーション]
780trip旅行、りょこう[トリップ]
781difference違い、ちがい[ディファレンス]
782situation状況、じょうきょう、シチュエーション[シチュエーション]
783matter問題、事柄、物質[マター]
784exam試験、テスト[イグザム]
785experiment実験、実験する、じっけん[エクスペリメント]
786mistake間違い、間違える、ミス[ミステイク]
787company会社、仲間、かいしゃ[カンパニー]
788factory工場、こうじょう[ファクトリー]
789customer顧客、客、きゃく[カスタマー]
790war戦争、せんそう[ウォー]
791earthquake地震、じしん[アースクエイク]
792danger危険、きけん[デンジャー]
793technology科学技術、テクノロジー、技術[テクノロジー]
794influence影響、影響を及ぼす、えいきょう[インフルエンス]
795problem問題、もんだい[プロブレム]
796oil油、石油、オイル[オイル]
797gas気体、ガス、ガソリン[ガス]
798energyエネルギー[エネルギー]
799noise騒音、雑音、ノイズ[ノイズ]
800garbageゴミ、ごみ[ガーベッジ]
801traffic accident交通事故、じこ[トラフィックアクシデント]
802environment環境、かんきょう[エンバイロメント]
803pollution汚染、おせん[ポリューション]
804global warming地球温暖化、おんだんか[グローバルウォーミング]
805peace平和、へいわ[ピース]`;

// --- データセット追加: イングリッシュゲート ---
const RAW_DATA_ENGLISH_GATE = `1favoriteお気に入り
2bank銀行
3basketballバスケットボール
4baseball野球
5bookstore本屋
6sleepy眠い
7sing歌う
8book本
9science科学
10school学校
11sister姉／妹
12pencilえんぴつ
13speak話す
14tennisテニス
15student学生
16study勉強する
17swim泳ぐ
18teaお茶
19teacher先生
20watch見る／腕時計
21Nice to meet you.はじめまして。
22Good bye.さようなら。
23Have a nice day!よい一日を！`;

// --- データセット2: 関正生 難関高校英単語 ---
const RAW_DATA_SEKI_KOKO = `1cancel中止にする、取り消す[キャンセル]
2cost（お金が）かかる、費用[コスト]
3trust信頼する[トラスト]
4receive受け取る[レシーブ]
5hit打つ、（災害が）襲う[ヒット]
6shut閉める[シャット]
7drop落ちる、落とす[ドロップ]
8check確認する[チェック]
9attend出席する[アテンド]
10express表現する[エクスプレス]
11choose選ぶ[チューズ]
12celebrate祝う[セレブレイト]
13support支える[サポート]
14notice気づく、注目する[ノーティス]
15continue続く、続ける[コンティニュー]
16judge判断する[ジャッジ]
17perform行う、演じる[パフォーム]
18post貼る、掲示する、投函する[ポスト]
19prepare準備する[プリペア]
20invent発明する[インベント]
21guess推測する、思う[ゲス]
22attract引きつける、魅了する[アトラクト]
23follow後を追う、従う[フォロー]
24add加える[アッド]
25pay支払う[ペイ]
26offer提供する、申し出る[オファー]
27exchange交換する[エクスチェンジ]
28expect期待する、予想する[エクスペクト]
29share共有する、分ける[シェア]
30imagine想像する[イマジン]
31seem～のようだ[シーム]
32graduate卒業する[グラジュエイト]
33appear現れる、見える[アピア]
34marry結婚する[マリー]
35disappear消える[ディスアピア]
36rise昇る、上がる[ライズ]
37raise上げる、育てる、（お金を）集める[レイズ]
38lead導く[リード]
39lieいる、ある、横になる[ライ]
40cause引き起こす[コーズ]
41lay置く、横にする[レイ]
42contribute貢献する、〜の原因になる[コントリビュート]
43impress印象を与える、感動させる[インプレス]
44hurt傷つける[ハート]
45amaze驚かせる[アメイズ]
46injure傷つける[インジャー]
47shock衝撃を与える[ショック]
48wound負傷させる、ケガをさせる[ウーンド]
49die死ぬ[ダイ]
50protect守る、保護する[プロテクト]
51survive生き延びる、〜より長生きする[サバイブ]
52destroy破壊する[デストロイ]
53escape逃げる[エスケープ]
54waste無駄にする[ウェイスト]
55burn燃やす[バーン]
56jumpジャンプする、跳ぶ[ジャンプ]
57knockノックする[ノック]
58cheer元気づける、歓声をあげる[チアー]
59brush磨く、ブラシ[ブラシ]
60shake振る[シェイク]
61greet挨拶する[グリート]
62pack詰める、荷物をまとめる[パック]
63pull引く[プル]
64hide隠す[ハイド]
65fold折りたたむ、（腕を）組む[フォールド]
66boilゆでる、沸かす[ボイル]
67bake焼く[ベイク]
68feed食べ物を与える[フィード]
69technology科学技術[テクノロジー]
70view眺め、見方、意見[ビュー]
71fact事実[ファクト]
72reason理由[リーズン]
73opinion意見[オピニオン]
74purpose目的[パーパス]
75result結果[リザルト]
76challenge挑戦、やりがい[チャレンジ]
77trouble心配、困難[トラブル]
78business仕事、事業[ビジネス]
79difficulty困難、苦労[ディフィカルティ]
80article記事[アーティクル]
81course進路、方向、コース[コース]
82experience経験[エクスペリエンス]
83symbol象徴、記号[シンボル]
84age年齢、時代[エイジ]
85peace平和[ピース]
86factory工場[ファクトリー]
87person人[パーソン]
88memory記憶[メモリー]
89skill技術[スキル]
90tool道具[ツール]
91silence静けさ、沈黙[サイレンス]
92instrument楽器、道具[インストゥルメント]
93furniture家具一式[ファニチャー]
94population人口[ポピュレーション]
95port港[ポート]
96fortune運、財産[フォーチュン]
97value価値[バリュー]
98adviceアドバイス、助言[アドバイス]
99decision決心、決断[デシジョン]
100truth真実[トゥルース]
101discount割引[ディスカウント]
102address住所、演説[アドレス]
103fee報酬、授業料、公共料金、手数料[フィー]
104figure人物、数字、図[フィギュア]
105rest休息、残り[レスト]
106interest興味、利益、利子[インタレスト]
107sight視力、景色[サイト]
108environment環境[エンバイロメント]
109manner方法、マナー[マナー]
110climate気候[クライメート]
111temperature温度[テンパチャー]
112oil石油、油[オイル]
113average平均[アベレージ]
114land陸地、国土[ランド]
115nature自然[ネイチャー]
116ocean海、大洋[オーシャン]
117island島[アイランド]
118desert砂漠[デザート]
119continent大陸[コンティネント]
120dessertデザート[デザート]
121jungleジャングル[ジャングル]
122leaf葉[リーフ]
123grass草[グラス]
124damage損害、被害[ダメージ]
125nest巣[ネスト]
126disaster災害[ディザスター]
127flood洪水[フラッド]
128space場所、宇宙[スペース]
129planet惑星[プラネット]
130pain痛み[ペイン]
131health健康[ヘルス]
132medicine薬[メディスン]
133fever熱[フィーバー]
134nurse看護師[ナース]
135soapせっけん[ソープ]
136past過去の、過去[パスト]
137meal食事[ミール]
138century世紀[センチュリー]
139recipeレシピ、調理法[レシピ]
140human人間、人類[ヒューマン]
141god神[ゴッド]
142soldier兵士[ソルジャー]
143heaven天国[ヘブン]
144enemy敵[エネミー]
145war戦争[ウォー]
146violence暴力[バイオレンス]
147government政府[ガバメント]
148capital首都、大文字[キャピタル]
149nation国家[ネイション]
150president大統領、社長[プレジデント]
151state州、国、状態[ステイト]
152mayor市長[メイヤー]
153law法律[ロー]
154vocabulary語彙[ボキャブラリー]
155statue像[スタチュー]
156sentence文[センテンス]
157movement動き、運動[ムーブメント]
158novel小説[ノベル]
159mystery謎、推理小説[ミステリー]
160relationship関係[リレーションシップ]
161gestureジェスチャー、身振り[ジェスチャー]
162community地域社会、共同体[コミュニティ]
163custom習慣、税関、関税[カスタム]
164neighbor近所の人、隣人[ネイバー]
165joke冗談[ジョーク]
166audience聴衆、観客[オーディエンス]
167guest招待客、宿泊客[ゲスト]
168customer顧客[カスタマー]
169passenger乗客[パッセンジャー]
170department部門[デパートメント]
171section部分、部門[セクション]
172owner所有者[オーナー]
173manager経営者、部長[マネージャー]
174visitor訪問者[ビジター]
175clerk事務員、店員[クラーク]
176tourist旅行者[ツーリスト]
177sightseeing観光[サイトシーイング]
178award賞、授与する[アワード]
179Olympicsオリンピック[オリンピックス]
180ceremony式、儀式[セレモニー]
181medalメダル[メダル]
182prize賞[プライズ]
183quizクイズ、小テスト[クイズ]
184essay作文、エッセイ[エッセイ]
185score得点[スコア]
186project計画、プロジェクト[プロジェクト]
187report報告書、レポート[レポート]
188presentationプレゼンテーション、発表[プレゼンテーション]
189topic話題[トピック]
190percentパーセント[パーセント]
191lesson練習、授業[レッスン]
192meterメートル[メーター]
193gym体育館[ジム]
194bottom底[ボトム]
195medium中間、媒体、手段[ミディアム]
196middle中間の[ミドル]
197circle円[サークル]
198road道路[ロード]
199traffic交通[トラフィック]
200flight飛行、航空便[フライト]
201block区画、ブロックする[ブロック]
202cyclingサイクリング、自転車に乗ること[サイクリング]
203step歩み、足元、段[ステップ]
204stairs階段[ステアーズ]
205elevatorエレベーター[エレベーター]
206track跡、道[トラック]
207field野原、田畑、分野[フィールド]
208hallホール、廊下[ホール]
209ceiling天井[シーリング]
210roof屋根[ルーフ]
211piece1つ、ひとかけら、作品[ピース]
212slice薄切り[スライス]
213sheet1枚の紙、シーツ[シート]
214noise騒音[ノイズ]
215styleスタイル、様式、方法[スタイル]
216scheduleスケジュール、予定を立てる[スケジュール]
217calendarカレンダー[カレンダー]
218listリストに入れる[リスト]
219meeting会議、ミーティング[ミーティング]
220systemシステム、制度[システム]
221model模型、型、手本[モデル]
222designデザイン、設計する[デザイン]
223courtコート、裁判所[コート]
224typeタイプ、活字[タイプ]
225engineer技術者、エンジニア[エンジニア]
226voice声[ボイス]
227actor俳優[アクター]
228actress女優[アクトレス]
229theater劇場、映画館[シアター]
230film映画[フィルム]
231professionalプロ、専門家[プロフェッショナル]
232license免許[ライセンス]
233shape形、（健康）状態[シェイプ]
234secret秘密[シークレット]
235date日付、デート[デイト]
236gift贈り物、才能[ギフト]
237cloth布[クロス]
238tieネクタイ、結ぶ[タイ]
239costume衣装[コスチューム]
240hole穴[ホール]
241copyコピー、（本・雑誌などの）冊、部[コピー]
242purse財布、ハンドバッグ[パース]
243aquarium水族館[アクアリウム]
244kid子ども[キッド]
245twin双子[ツイン]
246wave波、手を振る[ウェーブ]
247flag旗[フラッグ]
248rainbow虹[レインボー]
249cageかご[ケージ]
250vase花瓶[ベース]
251noteメモ、注意する、気づく[ノート]
252helpful役立つ、助けになる[ヘルプフル]
253useful役立つ[ユースフル]
254common共通の、よくある[コモン]
255traditional伝統的な、従来の[トラディショナル]
256original最初の、元々の、独創的な[オリジナル]
257unique独特の[ユニーク]
258local地元の、その土地の[ローカル]
259own自分自身の、所有する[オウン]
260dead死んでいる[デッド]
261comfortable心地よい、快適な[コンフォータブル]
262serious深刻な、まじめな[シリアス]
263severalいくつかの[セベラル]
264various様々な[バリアス]
265tough骨の折れる、丈夫な[タフ]
266normal普通の[ノーマル]
267precious貴重な[プレシャス]
268whole全体の、完全な[ホール]
269exact正確な[イグザクト]
270direct直接の、指導する、監督する[ダイレクト]
271rapid急速な[ラピッド]
272extra余分な[エクストラ]
273opposite反対の[オポジット]
274empty空の[エンプティ]
275physical身体の[フィジカル]
276total全部の、合計の[トータル]
277former以前の、前者の[フォーマー]
278ordinary普通の[オーディナリー]
279possible可能な[ポッシブル]
280impossible不可能な[インポッシブル]
281convenient便利な、都合がよい[コンビニエント]
282alive生きている[アライブ]
283asleep眠っている[アスリープ]
284certain確信して、ある～[サートゥン]
285ready準備ができた[レディ]
286fond大好きな[フォンド]
287proud誇りを持った[プラウド]
288similar似ている[シミラー]
289native本来その土地の、生まれつきの[ネイティブ]
290familiarよく知っている[ファミリア]
291absent欠席して[アブセント]
292independent独立した[インディペンデント]
293fluent流ちょうな[フルーエント]
294tropical熱帯の[トロピカル]
295wild野生の[ワイルド]
296mild穏やかな[マイルド]
297global地球規模の[グローバル]
298electric電気の[エレクトリック]
299scientific科学的な[サイエンティフィック]
300modern現代の[モダン]
301legal法律の、合法の[リーガル]
302individual個々の、個別の[インディビジュアル]
303personal個人の、個人的な[パーソナル]
304private個人的な、プライベートな[プライベート]
305public公共の[パブリック]
306elderly年配の[エルダーリー]
307male男性の・オスの[メール]
308female女性の・メスの[フィメール]
309equal平等の[イコール]
310blind盲目の・目が見えない[ブラインド]
311deaf耳が聞こえない[デフ]
312boring退屈な[ボーリング]
313enjoyable楽しい[エンジョイアブル]
314attractive魅力的な[アトラクティブ]
315terrible恐ろしい・ひどい[テリブル]
316pleasant楽しい・感じの良い[プレザント]
317positive前向きな・肯定的な[ポジティブ]
318negative消極的な・否定的な[ネガティブ]
319crazy気が狂った・夢中である[クレイジー]
320pale青ざめた[ペイル]
321lonely寂しい[ロンリー]
322honest正直な[オネスト]
323brave勇敢な[ブレイブ]
324shy恥ずかしがりの[シャイ]
325polite礼儀正しい・丁寧な[ポライト]
326nervous緊張して・神経質な[ナーバス]
327fair公平な・見本市[フェア]
328rude無礼な・失礼な[ルード]
329gentle優しい[ジェントル]
330smart賢い[スマート]
331foolish愚かな[フーリッシュ]
332clever賢い[クレバー]
333stupidバカな[ステューピッド]
334bright明るい・頭が良い[ブライト]
335thin薄い・細い・やせた[シン]
336thick厚い・太い[シック]
337loud（声・音が）大きい[ラウド]
338fresh新鮮な[フレッシュ]
339daily毎日の・日常の[デイリー]
340crowded混雑した[クラウディッド]
341perfect完璧な[パーフェクト]
342excellentすばらしい[エクセレント]
343fantasticすばらしい[ファンタスティック]
344outdoor屋外の[アウトドア]
345round丸い[ラウンド]
346tinyとても小さな[タイニー]
347huge巨大な[ヒュージ]
348giant巨大な[ジャイアント]
349primary最初の・重要な[プライマリー]
350basic基本的な[ベーシック]
351roughざらざらした・おおざっぱな[ラフ]
352elementary初歩の[エレメンタリー]
353smoothなめらかな[スムース]
354everyday日々の[エブリデイ]
355pure純粋な・きれいな[ピュア]
356clearきれいな・わかりやすい[クリア]
357sharp鋭い[シャープ]
358overseas海外へ[オーバーシーズ]
359outdoors外で[アウトドアーズ]
360upstairs上の階で[アップステアーズ]
361downtown町の中心部に[ダウンタウン]
362almostほとんど[オールモスト]
363nearlyほとんど[ニアリー]
364mostlyたいていは・大部分は[モストリー]
365actually実際は[アクチュアリー]
366unfortunately不運にも・あいにく[アンフォーチュネートリー]
367instead代わりに[インステッド]
368anymoreもはや（〜ない）[エニモア]
369thereforeしたがって[ゼアフォア]
370besidesその上・〜に加えて[ビサイズ]
371especially特に[エスペシャリー]
372gradually徐々に・だんだん[グラジュアリー]
373nowadays最近[ナウアデイズ]
374recently最近[リーセントリー]
375lately最近[レイトリー]
376eventuallyついに・結局は[イベンチュアリー]
377immediatelyすぐに・直接[イミディエートリー]
378hardlyほとんど〜ない[ハードリー]
379scarcelyほとんど〜ない[スケアスリー]
380rarelyめったに〜ない[レアリー]
381perhapsもしかすると[パーハップス]
382quiteかなり・完全に[クワイト]
383ratherむしろ・やや[ラザー]
384indeed本当に・実際には[インディード]
385forward前へ[フォワード]
386both両方とも[ボース]
387eitherどちらか・（否定で）どちらも〜ない[イーザー]
388neitherどちらも〜ない[ニーザー]
389straightまっすぐに[ストレイト]
390forever永遠に[フォーエバー]
391ahead前に[アヘッド]
392elseその他に[エルス]
393sincerely心から・敬具[シンシアリー]
394away離れて[アウェイ]
395aloud声に出して[アラウド]
396somedayいつか[サムデイ]
397sometimeいつか[サムタイム]
398somehow何とかして・なぜか[サムハウ]
399somewhereどこかで・どこかに[サムウェア]
400everywhereどこでも・あらゆるところで[エブリウェア]
401anytimeいつでも[エニタイム]
402anywhereどこでも[エニウェア]
403according〜によると[アコーディング]
404per〜につき[パー]
405whether〜かどうか・〜であろうと[ウェザー]`;

// --- データセット3: ターゲット1900 (1~800) ---
const RAW_DATA_TARGET_1900 = `1createを創り出す；を引き起こす
2increase増加する（⇔ decrease ⇒ 223）；を増やす
3improveを向上させる；よくなる
4meanを意味する；（...する）つもりである（to do）
5ownを所有している；（事実・罪など）を認める
6includeを含む（⇔ exclude ⇒ 1009）
7considerを見なす；について考える
8allowを許す；を与える；（～を）考慮に入れる（for）
9suggestを提案する；を暗示する
10produceを生産する；を取り出す
11decideを決める；に決着をつける
12offerを提供する，申し出る
13requireを要求する；を必要とする
14shareを共有する；を分担する
15storeを保存する；を蓄える
16tend傾向がある；を世話する
17concern〔受身形で〕心配している；〔受身形で〕（～に）関係する（with）；に関連する
18describeについて述べる，を説明する
19involveを関与させる；を伴う
20reduceを減らす；を（～に）変える（to）
21designを設計する；を計画する
22forceに強いる；を強要する
23limitを制限［規制］する
24bearに耐える（≒ endure ⇒ 824）；を負う；を産む；を（心に）抱く
25affectに影響を及ぼす（≒ influence ⇒ 49）；を感動させる
26deal〔deal withで〕を処理する；〔deal inで〕を商う；を分配する
27avoidを避ける
28relateを関連づける；（～に）関連する（to）
29realizeに気づく；を実現する
30encourageを奨励する；を励ます（⇔ discourage ⇒ 706）
31compareを比較する；を（～に）たとえる（to）
32measureを測る；を（比較して）評価する
33exist存在する；生存する
34markに印をつける；を（記号で）示す；に汚れをつける
35challengeに異議を唱える；（人）に挑む
36depend頼る；～次第である
37object反対する；（...）と言って反対する（that節）
38demandを要求する
39foundを設立する；（理論など）を（～に基づいて）築く（on）
40completeを完成させる，仕上げる
41idea考え，思いつき；理解；見解；概念
42accord一致；合意，協定
43company会社；〔集合的に〕仲間；（仲間と）一緒にいること；一座
44interest興味；利子；利害
45research（～についての）研究，調査（into / on / in）
46cause原因（⇔ effect ⇒ 48）；理由；大義
47reason理由；（...する）根拠（to do）；理性；分別
48effect影響，効果；結果
49influence影響（力）
50situation状況；（人の置かれた）立場
51environment環境（≒ surroundings）
52skill技能；熟練
53matter事柄；問題；〔～s〕事態；〔the ～〕困難；物質
54view（～についての）見解（on / about）；（～に対する）（特定の）見方（of）；眺め
55value価値；価格；評価；〔～s〕価値観
56species（生物の）種；種類
57thought考え；思考
58knowledge知識；知っていること；認識
59memory記憶（力）；（～の）思い出（of）
60practice実践，実行；（社会の）慣習；練習
61benefit利益，恩恵；給付金
62theory学説；理論；原理；推測
63issue問題（点）；発行（物）；発表
64experiment（～を対象とする）実験（on）
65article記事；条項；品物
66focus焦点；関心の的
67subject話題；科目；主題；被験者
68project計画；事業；研究計画
69quality質（⇔ quantity ⇒ 471）；特質
70role役割；（俳優などの）役
71term（専門）用語；〔～s〕条件；〔～s〕間柄；学期
72statement声明；主張；明細書
73material材料，素材；資料；生地
74evidence証拠
75source（～の）源，根源（of）；出所，情報源
76community（共同）社会，～界；地域社会；地域住民
77technology科学技術；応用技術
78culture文化；教養；耕作；養殖；培養
79appropriate（～に）適切な（for / to）
80likelyありそうな（⇔ unlikely ありそうもない）
81possible可能な；可能性のある
82individual個々の；個人の
83public公の（⇔ private 私的な）；公衆の；公開の
84common共通の；普通の；一般の
85certain確信して；確かな；ある；一定の
86similar似ている，類似した；同様の
87recent最近の
88major主要な；大きい（ほうの）；長調の
89patient忍耐強い；勤勉な
90particular特定の；特別の；（～について）やかましい（about）
91physical身体の（⇔ mental ⇒ 183）；物質的な；物理学の
92variousさまざまな；いくつかの
93available手に入る；利用できる；手が空いている
94native出生地の；原産の；生得の
95political政治（上）の
96due予定された；（支払）期日で；しかるべき
97blank空白の；無表情な；がらんとした
98ancient古代の；昔からの
99correct正しい；適切な
100despite～にもかかわらず（≒ in spite of）
101noticeに気づく
102refer言及する，関連する；参照する
103approachに近づく；に取り組む
104wonderかなと思う；（に）驚く（at）
105imagine（を）想像する；（を）推測する
106recognizeを識別できる；を認める
107solveを解く，解明する；（困難など）を解決する
108occur起こる；心に浮かぶ；現れる
109argueと主張する（≒ claim ⇒ 110, maintain ⇒ 206）；議論する
110claimと主張する；を（自分のものとして）要求する
111expressを表す，述べる
112drawを引き出す；を引く；を描く；近づく
113wasteを浪費する，無駄にする
114advanceを進歩させる；を進める；進歩する；進む
115spreadを広める；広がる
116prepareを準備する；を調理する；（～のために）準備をする（for）
117gainを獲得する；（を）増す
118achieveを達成する；を成し遂げる
119establishを確立する；を設立する
120supplyを供給する
121supposeと思う；と仮定する
122perform（を）行う；（を）演じる，（を）演奏する
123preferのほうを好む
124determineを決定する；を正確に知る
125treatを扱う；を治療する
126proveを証明する；判明する，わかる
127applyを適用［応用］する；申し込む；（～に）適用される（to / in）
128mentionに言及する；と言う
129communicate（～と）情報交換をする（with）；を伝達する
130containを含む；を収容する；（感情など）を抑える
131contactと連絡を取る；接触する
132regardを見なす；を見る；を評価する
133respectを尊敬する；を尊重する
134search捜す；を捜索する；を詳しく調べる
135connectをつなぐ；を関連づける
136decline減少する；衰退する；を断る
137preventを妨げる；を防ぐ
138suffer苦しむ；患う；（苦痛など）を経験する
139surviveを切り抜けて生き残る；より長生きする；生き延びる
140publishを出版する；を公表する
141opportunity機会（≒ chance）
142task（課せられた）仕事，作業；課題；タスク
143industry産業；勤勉（≒ diligence）
144medium（情報伝達の）媒体；手段
145economy経済（状態）；経済圏；節約
146policy政策，方針；（個人の）主義
147account説明；勘定；口座
148trade貿易；商売，取引
149model模範；モデル；模型；型
150figure数字；姿；人物；図表
151cell細胞；独房；電池
152image印象，イメージ；画像；像
153emotion感情，情動；感動
154stressストレス；圧力；強調
155decade10年間
156range範囲；射程距離；（同類の）組
157character性格，個性；特徴；登場人物；文字
158advantage利点；優勢；有利
159phrase句；成句；言葉遣い
160damage損害，損傷；〔～s〕損害賠償金
161impact影響；（激しい）衝突；衝撃（力）
162method方法；体系；秩序
163resource〔通例～s〕資源；〔通例～s〕資金；才覚
164region地域；領域；部位
165medicine薬；医学
166detail〔～s〕詳細（な情報），細部
167feature特徴；〔通例～s〕顔つき；特集記事［番組］
168function機能；関数
169access利用，入手；接近（の機会・方法・権利）
170item品目，項目；（同種の中の）～個；（短い）記事
171income収入；所得
172attitude態度；考え方，心構え
173site用地，場所；跡地；（ウェブ）サイト
174aspect（物事の）側面；観点；様相
175structure構造；体系；構造物
176habit習慣，癖
177link関連，つながり；（2地点を結ぶ）交通手段；リンク
178instance（具体的な）例，実例；（特定の）場合
179positive肯定的な；積極的な；確信して；（検査結果が）陽性の
180negative否定的な；消極的な；（検査結果が）陰性の
181complex複雑な；複合（体）の
182current現在の；現代の；通用している
183mental精神の；知能の；頭の中で行う
184specific特定の；明確な，具体的な；（～に）特有の（to）
185significant重要な，重大な；意義深い
186essential（～に）必要不可欠な（to / for）；本質的な
187official公用の；公式の；役所の
188financial財政（上）の；財界の
189academic学問の；大学の
190aware気づいて，知って
191worth（...する）に値する（doing）；の価値がある
192potential潜在的な；可能性を秘めた
193active積極的な；活動的な；効力のある
194digitalデジタル方式の；デジタル［数字］表示の
195mobile可動［移動］式の；流動性のある
196novel斬新な，目新しい
197plastic柔軟な；プラスチックの，ビニールの
198chemical化学の，化学的な
199necessary必要な（≒ essential ⇒ 186）
200eventually結局（は）
201identifyを特定する；を（～と）同一視する（with）
202representを表す；を代表する；に相当する
203indicateを指し示す；を述べる
204manageをなんとか成し遂げる；を管理する
205attendに出席する；（を）世話する；（～に）対処［対応］する（to）
206maintainを維持する；と主張する；を養う
207surveyを調査する；をじろじろ見る；を概観する
208replaceに取って代わる；を取り替える
209sortを（～に）分類する（into）；を（～から）えり分ける（from）
210conduct（調査・実験など）を実施する；を導く
211associateを結び付けて考える；（～と）交際する（with）
212attemptを試みる，企てる
213promoteを促進する；〔通例受身形で〕昇進する
214earnを稼ぐ；を得る；をもたらす
215uniteを団結させる；（を）結合する；団結する
216feedに食べ物［乳］を与える；に（～を）供給［補給］する（with）；餌を食べる
217seekを追い求める；（助けなど）を要請する
218observeに気づく；を観察する；を遵守する
219revealを明らかにする；を見せる
220estimateと推定する；を見積もる；を評価する
221reflectを反映する；（を）反射する；（を）熟考する
222attractを引きつける
223decrease減少する（⇔ increase ⇒ 2）；を減らす
224ignoreを無視する
225match（と）合う；に匹敵する；一致する
226defineを定義する；を明確にする
227adapt適応する；を（～に）適合させる（to）
228contribute貢献する，一因となる；（を）寄付する；（を）寄稿する
229exchange（を）交換する；両替する
230displayを示す；を発揮する；を展示［陳列］する
231respond反応する；答える
232hideを隠す（≒ conceal ⇒ 1116）；隠れる
233doubtではないと思う；を疑う
234removeを取り除く；を解雇する
235wind（ねじなど）を巻く；（道などが）曲がりくねる；巻きつく
236assumeを当然のことと思う，と仮定する；（権力など）を手に入れる；（責任など）を引き受ける
237relaxくつろぐ；緩む；をくつろがせる；を緩める
238satisfyを満足させる；（条件など）を満たす
239desireを強く望む
240succeed（～に）成功する（in）；（～を）継承する（to）
241concept概念；考え；（商品・販売の）コンセプト
242fashion流行，ファッション；方法，流儀
243device装置，機器；方策；デバイス
244charge料金；世話；管理；告発
245contrast（～との）対照（with / to）
246colleague（職場の）同僚
247pain苦痛，痛み；苦悩；〔～s〕骨折り
248bill請求書；【英】勘定書（≒ 【米】check）；法案
249content内容，中身；コンテンツ
250section部門；部分；地区；欄
251audience〔集合的に〕聴衆，観客；視聴者
252surface表面；〔the ～〕外見
253crop〔しばしば～s〕作物；収穫高
254topic話題，トピック；主題
255technique技術；技巧；手法
256status地位；状態
257option選択（の自由）；選択肢
258reward報酬；報い
259race人種；民族；競争
260crime罪，犯罪；違法行為
261conflict争い；論争；不一致
262struggle闘い；懸命の努力
263context状況，背景；文脈
264debate討論，論争；討論会
265fuel燃料；勢いを増加させるもの
266pollution汚染，公害
267trend（～への）傾向（toward）；流行
268balance均衡，バランス；（体の）平衡；残高
269traffic交通；通行；交通［輸送］量；（不正）取引
270strategy戦略
271basis基礎；根拠；基準
272consequence〔通例～s〕結果；重大性
273aim目的，目標；狙い
274ancestor祖先（⇔ descendant 子孫）；原型
275gene遺伝子
276track跡；軌道；【米】（鉄道の）番線；走路
277revolution革命；回転；（天体の）公転（⇔ rotation 自転）
278progress進歩；前進
279cognitive認知の
280ideal理想的な；観念的な
281efficient効率的な；有能な
282universal普遍的な；宇宙の；万能の
283vast莫大な；広大な
284extra追加の，余分の；別勘定の
285entire全体の，全部の（≒ whole）；完全な
286familiar精通している；よく知られている
287obvious明らかな（≒ clear）
288moral道徳（上）の，倫理的な；道徳的な
289ordinary一般の，普通の；並の
290equal（～に）等しい（to）；匹敵する；平等な
291previous以前の，前の
292FALSE間違った；虚偽の；偽の
293rareまれな，珍しい；希少な
294legal法律の；合法の（⇔ illegal 違法の）
295independent（～から）独立した（of / from）
296extreme極端な；極度の，過激な
297actual実際の，現実の
298willingいとわない，かまわないと思う
299urban都市の；都会的な（⇔ rural ⇒ 387）
300whereas～するのに（対し），～する一方
301predictを予言［予測］する
302examineを調べる；を診察する；を尋問する
303trustを信頼する；を（信頼して）託す
304stickを動けなくする；を突き刺す；（～に）くっつく（to / on）
305emerge現れる；明らかになる；台頭する
306varyさまざまである；変わる；を変える
307releaseを放出する；を解放する；を発表する
308divideを分ける；分かれる
309enable（人）が...できるようにする；を可能にする
310judge（を）判断する；に判決を下す
311rely頼る（≒ depend ⇒ 36）
312engageを従事させる；を（～として）雇う（as）；（～に）従事する（in / with）
313shiftを変える，移す；変わる；移動する
314adoptを採用する；（態度など）をとる；を養子にする
315acquireを得る；を習得する
316expand（を）拡大する；（を）詳説する
317refuseを拒む；を断る；拒絶する
318strikeの心を打つ；を襲う；を打つ；（に）ぶつかる
319repeat（を）繰り返す；を復唱する
320consumeを消費する；を食べる，飲む
321confuseを混同する；を当惑させる
322selectを選ぶ，えり抜く
323evolve（徐々に）発展する；進化する
324convinceを納得［確信］させる
325recallを思い出す；を呼び戻す
326destroyを破壊する；（人）を破滅させる
327preserveを保存する；を保持する；を保護する
328organizeを準備する；を組織する
329warn（人）に（～を）警告［注意］する（of / against）
330address（問題など）に対処する；に演説する；（手紙など）を（～宛てに）出す（to）
331operateを操作する；機能する；手術する
332participate参加する
333surroundを取り巻く；にまつわる
334flow流れる；（～から）生じる（from）
335bore（人）を退屈させる，うんざりさせる
336complain（と）不平［苦情］を言う；訴える
337hostを主催する；のホスト役を務める
338combineを（～と）結び付ける（with）；（～と）結び付く（with）
339extendを伸［延］ばす；伸びる；及ぶ
340appreciateを正当に評価する；を鑑賞する；を感謝する
341target（到達・攻撃）目標；的
342element要素，成分；元素；〔an / ofで〕少しの
343principle原則，原理；主義，信条
344phenomenon現象
345atmosphere〔the ～〕大気；雰囲気
346origin起源；源
347personality個性，性格
348capacity（最大）容量，収容能力；（潜在）能力
349profit利益；収益（率）；得
350circumstance〔通例～s〕状況，事情；境遇
351manner〔～s〕作法；方法；物腰
352threat脅威；（悪い）兆し；脅迫
353resident居住者；滞在者
354wealth富；資源；富裕
355institution機関；協会；施設；制度
356authority〔通例 the ～ties〕（関係）当局；権威；権限
357vote投票；投票結果；〔the ～〕選挙権
358sight光景；〔the ～s〕名所；見（え）ること；視野；視力
359campaign運動；軍事行動
360fund〔しばしば～s〕基金，資金
361web〔the W-〕ウェブ；（クモの）巣
362symbol象徴，シンボル；記号；標章
363analysis分析（結果）（⇔ synthesis ⇒ 1868）
364version（本・製品などの）版；解釈
365perspective観点，見方；大局観；遠近法
366crisis危機
367disaster災害；惨事
368lecture講義，講演；説教
369psychology心理学；心理（状態）
370gender（社会的・文化的）性，性別
371custom（社会的な）慣習；〔～s〕税関；〔～s〕関税
372court裁判所，法廷；裁判；宮廷；中庭
373desert砂漠；不毛の地
374soil土地，土壌；（悪事などの）温床
375agriculture農業；農学，畜産
376fossil化石；時代遅れの人［物］
377document（公）文書，書類；記録，資料
378vocabulary語彙
379intelligent聡明な；知能を有する
380conscious意識して，気づいて（≒ aware）
381capable能力がある；有能な
382accurate正確な；精密な
383fundamental基本的な；必須の
384artificial人工の（⇔ natural 自然の）；不自然な
385firm確固たる；堅固な；安定した
386overall総合的な；全体的な
387rural田舎の（⇔ urban ⇒ 299），田園の
388military軍の，軍事（用）の
389nuclear核の，原子力の
390biological生物学（上）の
391constant絶え間ない；一定の
392severe（人・規律・事態・天気などが）厳しい；猛烈な
393visual視覚の；目に見える
394enormous莫大な，巨大な
395convenient便利な，都合のいい
396domestic家庭の；国内の；（動物が）飼いならされた
397mass大規模な，大量の；大衆（向け）の
398typical典型的な；（～に）特有の（of）
399overseas海外へ［に，で］（≒ abroad）
400neverthelessそれにもかかわらず（≒ nonetheless ⇒ 1000）
401demonstrateを論証［証明］する；デモをする
402behave振る舞う；作動する
403educateを教育する；に教える；（能力など）を養う
404purchaseを購入する
405recommendを勧める
406admit（を）（しぶしぶ）認める；に（～への）入場［入学など］を認める（to / in）
407generateを生み出す；（電気など）を発生させる
408explore（を）調査［探究］する；（を）探検［探査］する
409amazeをびっくりさせる
410tearを引き裂く；裂ける
411settleを解決する；（に）移り住む；を落ち着かせる
412affordを持つ［する］余裕がある；を与える
413concludeと結論づける；を締めくくる；を締結する
414advertiseを宣伝する；（～を求める）広告を出す（for）
415encounterに遭遇する；に（思いがけず）出会う
416remindに思い出させる
417locate〔受身形で〕位置する；の位置を探し当てる
418aidを援助する，助ける（≒ help）
419bite（を）かむ，（に）かみつく；（を）刺す
420deliverを配達する；（演説・講義）をする；子を産む
421perceiveに気づく；を知覚する；を理解する
422distinguishを区別する
423implyを暗に意味する；を必然的に伴う
424handleを処理する，扱う；を論じる；を商う
425praiseを（～のことで）賞賛する（for）；賛美する
426appeal訴える；抗議する；（上級審に）上訴する
427insist（を）強く主張する；要求する
428compete競う；〔通例否定文で〕（～に）匹敵する（with）
429rankを位置づける，評価する；（ある地位に）位置する
430denyを否定する；を拒む
431rejectを拒否する
432intendを意図する
433exposeをさらす；を暴露する；を露出する
434favorに賛成する；を好む；をひいきする
435inspire（人）を奮起させる；を喚起する
436proposeを提案する；をもくろむ；結婚を申し込む
437spell（語）をつづる；という語になる
438breathe呼吸する；を吸う
439repairを修理する（≒ fix）；を修復する
440consist（～から）成る（of）；（～に）ある（in）
441comment意見，コメント；批判
442instruction〔通例～s〕指示；〔～s〕（製品の）使用書
443religion宗教；信条；信仰（心）
444neighborhood地域；近所
445laboratory実験室，研究室
446presence存在；出席；面前
447confidence自信；信頼；秘密
448harm害，損害
449instrument器具；楽器（≒ musical instrument）
450category部類，区分；範疇
451capital資本；首都；大文字（≒ capital letter）
452outcome結果（≒ result）；成果
453notion概念，観念；見解；意向
454review（書物などの）論評；再調査；【米】復習
455trait特性（≒ feature）
456diversity多様性；相違点
457victim犠牲（者），被害者
458occasion場合，時；行事；機会
459facility施設，設備；機能；才能
460stock在庫品；蓄え；株
461conference会議；協議
462humanity人類；人間性；人情；〔（the） ～ties〕人文科学
463dialect方言
464proportion割合；部分；釣り合い
465tip助言，秘訣；チップ；先端
466lawyer弁護士
467stuff（漠然と）物；素材；素質
468comfort快適さ；慰め
469philosophy哲学；原理；人生観
470mammal哺乳動物
471quantity量（⇔ quality ⇒ 69）；分量
472landscape風景；領域；状況
473tribe部族；仲間
474organ器官，臓器；組織；（パイプ）オルガン
475trial試み，（品質・性能などの）試験；裁判；試用期間
476norm規範；標準
477code規範；暗号；法典
478substance物質；実体；趣旨
479multiple多様な；種々雑多な
480numerous非常に数の多い
481narrow狭い；細い；限られた
482widespread広範囲にわたる；広く普及した
483sufficient（～に；...するのに）十分な（for；to do）
484proper適切な；正式の；〔名詞の後ろで〕主要な；（～に）固有の（to）
485linguistic言語の，言語学の
486annual年1回の，例年の；1年間の
487contemporary現代の；同時代の；同年輩の
488contrary（～と）反対の（to）
489strict（規則などが）厳しい；厳格な
490civil市民の；民間の；民事の（⇔ criminal 刑事の）
491odd奇妙な（≒ strange）；奇数の
492unknown不明の；（～に）知られていない（to），無名の
493superiorよりすぐれた（⇔ inferior ⇒ 1092）
494sensitive敏感な；神経質な；微妙な
495violent（人・気質などが）激しい；暴力的な
496virtual仮想の；事実上の
497regardless（～に）かまわない，無頓着な（of）
498immediate即座の；当面の；すぐそばの；直接の
499crucial重要な
500somewhatいくぶん，多少
501interpretを解釈する；（を）通訳する
502translateを翻訳する；を（～に）変える（into）
503concentrate（を）集中する
504requestに（...するように）頼む（to do）；を要請する
505criticizeを批判する；を批評する
506overcomeを克服する
507obtainを得る
508informに知らせる；情報を提供する
509ensureを確実にする（≒ make sure）；を守る
510announceを発表［公表］する，知らせる；（物事が）を告げる
511grant（人）に（許可・権利など）を与える；を認める
512freeze凍る；を凍らせる；（計画・資金など）を凍結する
513opposeに反対する；を対抗［対比］させる
514differ異なる
515hateをひどく嫌う；を残念に思う
516emphasizeを強調する；を重視する
517employを雇う（≒ give ～ a job）；を使う（≒ use）
518credit（功績など）を（～に）帰する（to）；を信じる
519transformを変える；変わる
520constructを建設する（＝ build）；を構成する
521arise生じる
522beatを打ち負かす；（を）打つ，たたく
523regretを後悔する
524alterを変える；変わる（≒ change）
525absorbを吸収する；を併合する；を夢中にさせる
526disappointを失望させる；（希望など）をくじく
527cureを治す；を取り除く；（病気が）治る
528transportを輸送する；を運ぶ
529rush急いで行く；性急に行動する；をせき立てる
530hangを掛ける；を絞首刑にする；垂れ（下が）る
531blameを責める；の責任を負わせる
532banを（法的に）禁止する；を締め出す
533fascinateを魅了する
534recover回復する；を取り戻す
535celebrateを祝う；を挙行する
536manufactureを製造する；をでっち上げる
537interact影響し合う；相互に作用する
538arrangeの段取りをつける；を手配する；を配置する
539adjustを調整する；を適合させる；順応する
540confirmを確認する；を裏づける
541insight見識，理解（力）；洞察力
542innovation革新；新機軸
543budget予算；経費
544fee料金；謝礼
545expense〔～s〕経費；費用；犠牲
546debt借金，負債；恩義
547loan貸付金，融資；貸すこと
548duty義務；〔しばしば～ties〕職務；関税
549alarm不安，恐れ；警報装置
550emergency緊急（事態）
551democracy民主主義，民主政治；民主国家
552minister大臣；（プロテスタント系の）聖職者
553fellow仲間，同僚；同級生；男
554candidate（～の）候補（者）（for）；志願者
555corporation（大）企業；法人
556stereotype固定観念；決まり文句
557route道（筋）；路線，ルート；（～の）手段（to）
558disorder障害，（心身の）不調；混乱
559depression憂うつ；うつ病；不況；低気圧
560weapon兵器，武器（≒ arms）
561immigration（他国からの）移民，移住；入国管理
562barrier（～に対する）障壁（against / to）；防壁
563disadvantage不利（な点）；障害；（信用などの）損失
564mood気分；機嫌；雰囲気
565motion動き，動作；運動；動議
566routine決まり切った仕事；いつもの手順
567discipline規律，しつけ；訓練；懲戒；学問分野
568myth作り話；神話
569hypothesis仮説；憶測
570physician【主に米】 医師（≒ doctor）；内科医
571client顧客（≒ customer）；（弁護士などの）依頼人
572colony植民地；集団居住地；（動植物の）コロニー
573statistics統計；統計学
574grain穀物；粒；きめ
575ingredient材料，成分；（成功の）要因
576treasure宝物，財宝；財産
577contract契約（書）；協定
578welfare福祉，幸福
579prime主要な，最も重要な；最適な；極上の
580curious好奇心の強い；奇妙な
581dramatic劇的な；演劇の
582distinct明らかに異なる；明瞭な
583anxious心配して；切望して
584vital必要不可欠な；活気のある；生命にかかわる
585conventional従来の；月並みな
586abstract抽象的な（⇔ concrete ⇒ 783）
587minor重要でない；小さい（⇔ major ⇒ 88）
588extraordinary並はずれた；異常な，驚くべき
589stable安定した（⇔ unstable 不安定な）；動じない
590flexible融通の利く，柔軟な
591brief簡潔な；短い
592aggressive攻撃的な；意欲的な
593visible（目に）見える（⇔ invisible 見えない）；明白な
594unexpected思いがけない，不意の
595ethnic民族の，人種の；民族特有の
596alien（～にとって）異質の（to）；外国の；宇宙人の
597initial初めの
598exact正確な；まさにその
599precise正確な（≒ exact）；精密な；まさにその
600latter後者の（⇔ former 前者の），後半の
601commit〔commit oneselfまたは受身形で〕献身する；（罪など）を犯す；を投入する
602stimulateを刺激する
603enhance（価値など）を高める，増す
604pursueを追求する；に従事する
605react反応する；化学反応を起こす
606disagree不賛成である；意見が食い違う
607stareじっと見る；を見つめる
608abandonを捨てる；を放棄する，断念する
609quitをやめる；（場所）を去る
610captureをとらえる；をとりこにする
611transferを移す；を伝える；移る；乗り換える
612botherを悩ます；（～を）気にかける（about / with）
613persuadeを説得する；に確信させる
614rentを賃借りする；を賃貸しする
615breedを繁殖させる，育てる；繁殖する
616invest（を）投資する；に（～を）与える（with）
617reserveを予約する；を取っておく；（判断など）を保留する
618trace（足跡・起源など）をたどる；を捜し出す
619illustrateを説明する；に挿絵を入れる
620adviseに忠告［助言］する；（を）助言する
621conveyを伝える；を運ぶ，運搬する
622attachを（取り）付ける；を付与する
623stretchを伸ばす；を広げる；伸びる；及ぶ
624puzzleを当惑させる
625disturbをかき乱す；を妨害する；を動揺させる
626crash衝突する，墜落する；をぶつけて壊す
627copeうまく処理する
628permitを許可する（≒ allow）（⇔ forbid ⇒ 1013）
629impressを感動させる；に印象を与える
630suspectではないかと思う；（人）を疑う
631upsetを動揺させる；をだめにする
632frighten（人）を怖がらせる
633importを輸入する（⇔ export （を）輸出する）；を取り込む
634export（を）輸出する（⇔ import を輸入する）
635investigateを調査する；を究明する；（～を）調査する（into）
636monitorを監視する；を傍受する
637calculateを計算する；を予測する
638eliminateを取り除く
639easeを軽減する；和らぐ；緩む
640launchを開始する；を売り出す；を発射する
641sequence連続；一連（のもの）
642therapy療法；心理療法
643symptom症状；兆候（≒ sign）
644incident出来事，事件；紛争
645witness目撃者（≒ eyewitness）；証人；証拠，証言
646sum（金）額；合計；要点
647burden負担；（重い）義務；積み荷
648tone口調；音色；雰囲気；色調
649honor光栄；名誉（⇔ dishonor 不名誉）；敬意
650award（～の）賞（for）；（証書などの）授与
651priority優先（事項）
652logic論理；道理；論理学
653minimum最小限度（⇔ maximum ⇒ 965）
654exception（～の）例外（to）
655clue（～の）手がかり（to / about）；（パズルの）ヒント
656bond絆；債券；束縛；接着剤
657virusウイルス；（感染症の）病原体
658surgery（外科）手術；外科，外科医学
659insurance保険；保険料；保険金
660frame枠，（額）縁；骨組み；体格
661shelter避難（所），保護
662territory領土；（活動の）領域；（動物の）テリトリー
663boundary境界（線）；〔通例～ries〕限界
664habitat生息地；（人の）居住地
665district地区；行政区
666conservation（動植物などの）保護；保存
667harvest収穫（物）；収穫期；漁獲高
668predator捕食動物；略奪者
669trapわな；苦境
670trickこつ；策略；いたずら；芸当
671fault〔通例one's ～〕責任；欠点；誤り
672discount割引
673bias偏見；傾向
674cooperation協力，共同
675patent特許（権）；特許品
676dialogue対話，会話；意見の交換
677component構成要素；部品
678reputation評判；名声
679verbal言葉の；口頭での；動詞の
680internal内部の（⇔ external ⇒ 989）；国内の；内面的な
681solidしっかりした；硬い；固体の
682remote（～から）遠く離れた（from）；かけ離れた
683principal主要な；資本金の
684sophisticated高性能の，精巧な；洗練された
685equivalent等しい，相当する
686rational理性的な；合理的な
687relevant関係がある；適切な
688absolute絶対的な（⇔ relative 相対的な）
689frequent頻繁な
690permanent永続的な（⇔ temporary ⇒ 793）
691intense強烈な；熱烈な
692meaningful意味のある
693evil邪悪な；有害な
694extinct絶滅した；廃止された
695random無作為の；手当たり次第の
696raw生の；未加工の
697rude無礼な（⇔ polite 礼儀正しい）；粗野な
698mere単なる，ほんの
699tropical熱帯の
700forth前へ，先へ；それ以降
701possessを所有している；の心をとらえる
702dominateを支配する；（～より）優勢である（over）
703guaranteeを保証する
704melt溶ける；なごむ；を溶かす
705embarrassに恥ずかしい思いをさせる
706discourage（人）にやる気をなくさせる；を落胆させる（⇔ encourage ⇒ 30）
707detectを感知する；を見つけ出す；に気づく
708devoteをささげる
709urgeに（強く）促す；を強く主張する；を駆り立てる
710lendを貸す（⇔ borrow を借りる）；（人）に（助言・援助など）を与える
711restrictを制限する
712isolateを孤立させる
713accompanyに同行する；に付随する
714exhaustを疲れ果てさせる；を使い尽くす；排気する
715annoyを悩ます；〔受身形で〕腹が立つ
716endangerを危険にさらす
717acknowledge（事実など）を認める（≒ admit ⇒ 406）；に謝意を表す
718admireに（～のことで）敬服［感心］する（for）
719evaluateを評価する；を査定する
720declareを宣言する；を申告する
721secureを確保する；を守る
722specialize専門とする；【英】（～を）専攻する（in）（≒ 【米】major）
723attribute（結果など）を（～に）帰する（to）
724pretend（の）ふりをする
725buryを埋める；を埋葬する；を隠す
726reverseを逆転させる；を反対にする
727resistに抵抗する；〔通例否定文で〕を我慢する
728scareをおびえさせる；を脅す
729imitateをまねる；を模造する
730assist（を）援助する；を手伝う
731resembleに似ている
732retire（～から）引退する，退職する（from）；退く
733neglectをおろそかにする，怠る；を無視する
734collapse崩壊する；（人が）倒れる；を折り畳む
735reformを改革する；を改心させる
736protest（に）抗議する；を主張する
737oweに借りがある；のおかげである
738sustainを持続させる；を支える
739assignを割り当てる；を（～に）配属する（to）
740accomplishを成し遂げる
741wisdom知恵；賢明さ；学識
742literacy読み書きの能力；（特定分野の）知識
743heritage遺産
744mission使命；（外交）使節団；布教
745license免許（証）；許可
746elite〔通例the ～〕〔集合的に〕エリート
747layer層
748motorモーター；原動力
749proteinたんぱく質
750profession職業；専門職；同業者仲間
751editor編集者；編集長
752agent仲介者，代理人；薬剤
753globe地球（≒ earth）；世界；球
754haven避難所，保護区；港
755row列；（建物が並ぶ）通り
756sacrifice犠牲；いけにえ
757means〔単数・複数扱い〕手段；〔複数扱い〕資力，収入
758session集まり；（議会の）会期；（開会中の）議会
759league（競技）連盟；同盟
760contestコンテスト，競技（会）；争い
761guard警備員；警備隊；監視，警戒
762opponent（試合・論争などの）相手；反対者
763glance（～を）ちらっと見ること（at）
764divorce離婚；分離
765tissue（生物の）組織；ティッシュペーパー
766liquid液体
767inequality不平等；不公平な事柄
768prejudice（～に対する）偏見（against）（≒ bias）
769justice公正，正義；司法
770guideline指針，ガイドライン；指導基準
771platformプラットフォーム；演壇；舞台
772sector（社会・経済などの）部門，セクター；（都市内の）地域
773channelチャンネル；伝達経路；海峡
774glacier氷河
775primate霊長目の動物
776usage（使）用法；語法；習慣
777fortune財産；幸運（≒ luck）；運命
778correlation相互関係，相関（関係）
779artistic芸術的な
780literary文学の；文語の（⇔ colloquial 口語体の）
781classic第一級の；典型的な；定番の
782liberal自由主義の；寛大な；一般教養の
783concrete具体的な（⇔ abstract ⇒ 586）；有形の
784slightわずかな；取るに足らない
785federal連邦（政府）の
786primitive原始的な；未開の
787unfamiliar（～に）不慣れな（with）；（～に）（よく）知られていない（to）
788subtle微妙な；（気体などが）希薄な
789plain明らかな；平易な；飾りのない；率直な
790marine海の；船舶の
791apparent明白な；一見～らしい
792reluctant気が進まない，嫌がる（⇔ willing ⇒ 298）
793temporary一時的な（⇔ permanent ⇒ 690）
794guilty罪悪感のある；（～について）有罪の（of）
795royal王の
796pure純粋な；潔白な；まったくの
797incredible信じられない；すばらしい
798eager（～を）熱望して（for）；熱心な
799adequate十分な；適切な（⇔ inadequate 不適切な）
800via～経由で；～の媒介で`;

const DATA_SETS = {
  master800: {
    id: 'master800',
    title: '英単語マスター 800',
    data: RAW_DATA_MASTER_800
  },
  englishGate: {
    id: 'englishGate',
    title: 'イングリッシュゲート',
    data: RAW_DATA_ENGLISH_GATE
  },
  seki_koko: {
    id: 'seki_koko',
    title: '関正生 難関高校英単語 (1-405)',
    data: RAW_DATA_SEKI_KOKO
  },
  target1900: {
    id: 'target1900',
    title: 'ターゲット1900 (1~800)',
    data: RAW_DATA_TARGET_1900
  }
};

// ==========================================
// 2. 型定義 & ユーティリティ
// ==========================================

const normalizeWordAndMeaning = (word, meaning) => {
  let normalizedWord = word.trim();
  let normalizedMeaning = meaning.trim();

  const trailingDigitsMatch = normalizedWord.match(/^(.*?)(\d+)$/);
  if (trailingDigitsMatch) {
    const baseWord = trailingDigitsMatch[1].trim();
    const digits = trailingDigitsMatch[2];
    if (baseWord.length > 0) {
      normalizedWord = baseWord;
      normalizedMeaning = `${digits}${normalizedMeaning}`;
    }
  }

  return { word: normalizedWord, meaning: normalizedMeaning };
};
const parseWordList = (rawData) => {
  const lines = rawData.split('\n').filter(line => line.trim() !== '');
  
  return lines.map(line => {
    // フォーマット: ID + Word + Meaning + [Reading]
    const match = line.match(/^(\d+)([a-zA-Z0-9\s\.\-\’\'\/!\?]+)([^\[]+)(\[(.+?)\])?$/);

    if (!match) {
      const fallbackMatch = line.match(/^(\d+)([a-zA-Z0-9\s\.\-\’\'\/!\?]+?)(.*)$/);
      if (!fallbackMatch) {
        return { id: 0, word: line, meaning: 'Parse Error', pronunciation: '', variations: [] };
      }
      const id = parseInt(fallbackMatch[1], 10);
      let word = fallbackMatch[2].trim();
      let meaningRaw = fallbackMatch[3].trim();
      ({ word, meaning: meaningRaw } = normalizeWordAndMeaning(word, meaningRaw));
      const splitRegex = /[、,／/\s\[\]\(\)（）]+/;
      const variations = meaningRaw.split(splitRegex).filter(s => s.length > 0);
      return { id, word, meaning: meaningRaw, pronunciation: '', variations };
    }

    const id = parseInt(match[1], 10);
    let word = match[2].trim();
    let meaningRaw = match[3].trim();
    ({ word, meaning: meaningRaw } = normalizeWordAndMeaning(word, meaningRaw));
    const pronunciation = match[5] ? match[5].trim() : ''; // []の中身

    // 区切り文字を強化
    const splitRegex = /[、,／/\s\[\]\(\)（）]+/;
    let variations = meaningRaw.split(splitRegex).filter(s => s.length > 0);
    
    const cleanVariations = variations.map(v => v.replace(/[〜\(\)（）\[\]]/g, '')).filter(v => v.length > 0);
    variations = [...new Set([...variations, ...cleanVariations])];

    return {
      id,
      word,
      meaning: meaningRaw,
      pronunciation,
      variations
    };
  });
};

const shuffleArray = (array) => {
  const newArray = [...array];
  for (let i = newArray.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
  }
  return newArray;
};

const attachDatasetMetadata = (words, datasetId) =>
  words.map(word => ({ ...word, datasetId }));

const VOICE_THRESHOLD = 0.22;
const VOLUME_VISUAL_MULTIPLIER = 4;
const MISTAKE_STORAGE_KEY = 'word-test-app:mistakes';

const readMistakeWordsFromStorage = () => {
  if (typeof window === 'undefined') return [];
  try {
    const stored = window.localStorage.getItem(MISTAKE_STORAGE_KEY);
    if (!stored) return [];
    const parsed = JSON.parse(stored);
    if (!Array.isArray(parsed)) return [];
    return parsed.filter(word =>
      word && typeof word === 'object' && typeof word.id === 'number' && word.datasetId
    );
  } catch (error) {
    console.warn('Failed to read mistake words from storage', error);
    return [];
  }
};

// ==========================================
// 3. メインコンポーネント
// ==========================================

export default function App() {
  const [appState, setAppState] = useState('home');
  const [selectedDatasetId, setSelectedDatasetId] = useState('master800');
  
  // 選択されたデータセットに基づいて単語リストを生成
  const wordList = useMemo(() => {
    const dataset = Object.values(DATA_SETS).find(d => d.id === selectedDatasetId) || DATA_SETS.master800;
    return parseWordList(dataset.data);
  }, [selectedDatasetId]);
  
  const [rangeStart, setRangeStart] = useState(1);
  const [rangeEnd, setRangeEnd] = useState(10);
  const [isRandom, setIsRandom] = useState(false);
  const [timeLimit, setTimeLimit] = useState(10);
  const [flashcardPhase, setFlashcardPhase] = useState('question');
  
  const [testWords, setTestWords] = useState([]);
  const [currentIndex, setCurrentIndex] = useState(0);
  const [timeLeft, setTimeLeft] = useState(10);
  const [results, setResults] = useState([]);
  
  // 復習モード用のState
  const [isReviewMode, setIsReviewMode] = useState(false);
  const [reviewTargetWords, setReviewTargetWords] = useState([]); // 復習で固定された単語リスト
  
  // 間違い単語リスト
  const [mistakeWords, setMistakeWords] = useState(() => readMistakeWordsFromStorage());
  const [isMistakeMode, setIsMistakeMode] = useState(false);

  const [micModeEnabled, setMicModeEnabled] = useState(true);
  const [micStatus, setMicStatus] = useState('idle');
  const [volumeLevel, setVolumeLevel] = useState(0);
  const [voiceTriggerSatisfied, setVoiceTriggerSatisfied] = useState(false);

  useEffect(() => {
    if (typeof window === 'undefined') return;
    const storedValue = window.localStorage.getItem('voice-trigger:mic-mode');
    if (storedValue !== null) {
      setMicModeEnabled(storedValue === 'true');
    }
  }, []);

  useEffect(() => {
    if (typeof window === 'undefined') return;
    window.localStorage.setItem('voice-trigger:mic-mode', micModeEnabled ? 'true' : 'false');
  }, [micModeEnabled]);

  const audioContextRef = useRef(null);
  const analyserRef = useRef(null);
  const dataArrayRef = useRef(null);
  const mediaStreamRef = useRef(null);
  const rafRef = useRef(null);
  const voiceTriggerSatisfiedRef = useRef(false);

  const timerRef = useRef(null);
  useEffect(() => {
    voiceTriggerSatisfiedRef.current = voiceTriggerSatisfied;
  }, [voiceTriggerSatisfied]);

  const stopAudioMonitoring = useCallback(() => {
    if (rafRef.current) {
      cancelAnimationFrame(rafRef.current);
      rafRef.current = null;
    }
    if (analyserRef.current) {
      try {
        analyserRef.current.disconnect();
      } catch (error) {
        console.warn('Failed to disconnect analyser node', error);
      }
      analyserRef.current = null;
    }
    if (audioContextRef.current) {
      audioContextRef.current.close();
      audioContextRef.current = null;
    }
    if (mediaStreamRef.current) {
      mediaStreamRef.current.getTracks().forEach(track => track.stop());
      mediaStreamRef.current = null;
    }
    dataArrayRef.current = null;
    setVolumeLevel(0);
  }, []);

  const isMicOperational = micStatus !== 'error' && micStatus !== 'unsupported';
  const shouldEnforceVoiceTrigger = micModeEnabled && isMicOperational;

  useEffect(() => {
    if (appState !== 'test' || flashcardPhase !== 'question') return;
    setVoiceTriggerSatisfied(!shouldEnforceVoiceTrigger);
  }, [appState, currentIndex, flashcardPhase, shouldEnforceVoiceTrigger]);

  const addWordToMistakeList = useCallback((word) => {
    if (!word) return;
    setMistakeWords(prev => {
      const exists = prev.some(item => item.id === word.id && item.datasetId === word.datasetId);
      if (exists) return prev;
      return [...prev, { ...word }];
    });
  }, []);

  const removeWordFromMistakeList = useCallback((word) => {
    if (!word) return;
    setMistakeWords(prev => prev.filter(item => !(item.id === word.id && item.datasetId === word.datasetId)));
  }, []);

  useEffect(() => {
    if (typeof window === 'undefined') return;
    try {
      window.localStorage.setItem(MISTAKE_STORAGE_KEY, JSON.stringify(mistakeWords));
    } catch (error) {
      console.warn('Failed to persist mistake words', error);
    }
  }, [mistakeWords]);

  const goHome = useCallback(() => {
    setAppState('home');
    setIsMistakeMode(false);
    setIsReviewMode(false);
    setFlashcardPhase('question');
  }, []);

  // データセットが変更されたら、rangeEndを自動調整
  useEffect(() => {
    setRangeEnd(Math.min(10, wordList.length));
    setRangeStart(1);
  }, [wordList.length]);

  useEffect(() => {
    if (!micModeEnabled || appState !== 'test') {
      stopAudioMonitoring();
      setMicStatus('idle');
      return;
    }

    if (!navigator?.mediaDevices?.getUserMedia) {
      setMicStatus('unsupported');
      return;
    }

    let isCancelled = false;

    const setupMicrophone = async () => {
      try {
        setMicStatus('requesting');
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        if (isCancelled) {
          stream.getTracks().forEach(track => track.stop());
          return;
        }

        const AudioContextClass = window.AudioContext || window.webkitAudioContext;
        if (!AudioContextClass) {
          setMicStatus('unsupported');
          stream.getTracks().forEach(track => track.stop());
          return;
        }

        const audioCtx = new AudioContextClass();
        const analyser = audioCtx.createAnalyser();
        analyser.fftSize = 2048;
        const source = audioCtx.createMediaStreamSource(stream);
        source.connect(analyser);

        audioContextRef.current = audioCtx;
        analyserRef.current = analyser;
        mediaStreamRef.current = stream;
        dataArrayRef.current = new Uint8Array(analyser.fftSize);

        setMicStatus('listening');

        const updateVolume = () => {
          if (!analyserRef.current || !dataArrayRef.current) return;

          analyserRef.current.getByteTimeDomainData(dataArrayRef.current);
          let sumSquares = 0;
          for (let i = 0; i < dataArrayRef.current.length; i += 1) {
            const value = (dataArrayRef.current[i] - 128) / 128;
            sumSquares += value * value;
          }
          const rms = Math.sqrt(sumSquares / dataArrayRef.current.length);
          setVolumeLevel(rms);

          if (micModeEnabled && !voiceTriggerSatisfiedRef.current && rms >= VOICE_THRESHOLD) {
            setVoiceTriggerSatisfied(true);
          }

          rafRef.current = requestAnimationFrame(updateVolume);
        };

        updateVolume();
      } catch (error) {
        console.error('Microphone access failed', error);
        setMicStatus('error');
        stopAudioMonitoring();
      }
    };

    setupMicrophone();

    return () => {
      isCancelled = true;
      stopAudioMonitoring();
    };
  }, [micModeEnabled, appState, stopAudioMonitoring]);

  const speakWord = useCallback((text, onEnd) => {
    if ('speechSynthesis' in window) {
      window.speechSynthesis.cancel();
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      utterance.rate = 1.0;
      utterance.pitch = 1.0;
      utterance.onend = () => { if (onEnd) onEnd(); };
      utterance.onerror = () => { if (onEnd) onEnd(); };
      window.speechSynthesis.speak(utterance);
    } else {
      if (onEnd) onEnd();
    }
  }, []);

  const startTest = useCallback(() => {
    const validStart = Math.max(1, Math.min(rangeStart, wordList.length));
    const validEnd = Math.min(wordList.length, Math.max(rangeEnd, validStart));
    let words = wordList.filter(w => w.id >= validStart && w.id <= validEnd);
    
    if (words.length === 0) {
      alert('指定範囲に単語がありません');
      return;
    }

    words = attachDatasetMetadata(words, selectedDatasetId);
    if (isRandom) words = shuffleArray(words);

    setTestWords(words);
    setCurrentIndex(0);
    setResults([]);
    setIsReviewMode(false); // 通常テスト
    setIsMistakeMode(false);
    setFlashcardPhase('question');
    setAppState('test');
  }, [rangeStart, rangeEnd, wordList, isRandom, selectedDatasetId]);

  // 復習モード開始（初回）
  const startReview = useCallback(() => {
    const wrongWordIds = results.filter(r => !r.isCorrect).map(r => r.wordId);
    let reviewWords = wordList.filter(w => wrongWordIds.includes(w.id));
    
    if (reviewWords.length === 0) return;

    reviewWords = attachDatasetMetadata(reviewWords, selectedDatasetId);
    // 変更: 復習モードは設定に関わらず常にランダムにシャッフルする
    reviewWords = shuffleArray(reviewWords);

    // 復習ターゲットを固定
    setReviewTargetWords(reviewWords);
    setTestWords(reviewWords);
    setIsReviewMode(true); // 復習モードON
    setIsMistakeMode(false);

    setCurrentIndex(0);
    setResults([]); 
    setFlashcardPhase('question');
    setAppState('test');
  }, [results, wordList, selectedDatasetId]); // isRandomへの依存を削除

  // 復習リトライ（リストを減らさずに再挑戦）
  const retryReview = useCallback(() => {
    // 変更: リトライ時も常にシャッフル
    let words = shuffleArray([...reviewTargetWords]);

    setTestWords(words);
    setCurrentIndex(0);
    setResults([]); 
    setFlashcardPhase('question');
    setIsMistakeMode(false);
    setAppState('test');
  }, [reviewTargetWords]); // isRandomへの依存を削除

  const startMistakeDrill = useCallback(() => {
    if (mistakeWords.length === 0) return;
    let words = shuffleArray([...mistakeWords]);

    setTestWords(words);
    setCurrentIndex(0);
    setResults([]);
    setIsReviewMode(false);
    setIsMistakeMode(true);
    setFlashcardPhase('question');
    setAppState('test');
  }, [mistakeWords]);

  const handleRemoveCurrentMistakeWord = useCallback(() => {
    if (!isMistakeMode) return;
    const currentWord = testWords[currentIndex];
    if (!currentWord) return;

    removeWordFromMistakeList(currentWord);
    const updatedWords = testWords.filter(word => !(word.id === currentWord.id && word.datasetId === currentWord.datasetId));
    setTestWords(updatedWords);

    if (updatedWords.length === 0) {
      setResults([]);
      setCurrentIndex(0);
      goHome();
      return;
    }

    const nextIndex = Math.min(currentIndex, updatedWords.length - 1);
    setCurrentIndex(nextIndex);
    setFlashcardPhase('question');
  }, [isMistakeMode, testWords, currentIndex, removeWordFromMistakeList, goHome]);

  // 問題開始・フェーズ変更時の処理
  useEffect(() => {
    if (appState !== 'test') return;
    
    // このEffectの実行が有効かどうかを判定するフラグ
    let isMounted = true;
    
    const currentWord = testWords[currentIndex];

    // 答えを表示している場合はタイマーを止める
    if (flashcardPhase === 'answer') {
        if (timerRef.current) {
             clearInterval(timerRef.current);
             timerRef.current = null;
        }
        return; 
    }
    
    // 初期化：残り時間をリセットし、既存タイマーをクリア
    setTimeLeft(timeLimit);
    if (timerRef.current) {
        clearInterval(timerRef.current);
        timerRef.current = null;
    }

    const startTimer = () => {
        // マウントされていない、または既にタイマーが動いている場合は何もしない
        if (!isMounted) return;
        
        // 既存のタイマーがあればクリア（二重起動防止の徹底）
        if (timerRef.current) {
             clearInterval(timerRef.current);
        }

        // タイマー開始
        timerRef.current = setInterval(() => {
          if (!isMounted) {
              if (timerRef.current) clearInterval(timerRef.current);
              return;
          }
          setTimeLeft((prev) => {
            if (prev <= 1) {
              setFlashcardPhase('answer'); 
              // タイマー停止
              if (timerRef.current) {
                  clearInterval(timerRef.current);
                  timerRef.current = null;
              }
              return 0;
            }
            return prev - 1;
          });
        }, 1000);
    };

    // 音声読み上げとタイマー開始のフロー
    if (currentWord && flashcardPhase === 'question') {
        const delayTimer = setTimeout(() => {
            if (!isMounted) return;

            speakWord(currentWord.word, () => {
                // 音声読み上げ終了時のコールバック
                if (isMounted) {
                    startTimer();
                }
            });
        }, 600);

        // クリーンアップ関数
        return () => {
            isMounted = false;
            clearTimeout(delayTimer);
            if (timerRef.current) {
                clearInterval(timerRef.current);
                timerRef.current = null;
            }
            window.speechSynthesis.cancel();
        };
    } else if (flashcardPhase === 'question') {
        // 音声なしですぐタイマー開始する場合
        startTimer();
        return () => {
            isMounted = false;
            if (timerRef.current) {
                clearInterval(timerRef.current);
                timerRef.current = null;
            }
        };
    }

    // アンマウント時のクリーンアップ
    return () => {
        isMounted = false;
        if (timerRef.current) {
             clearInterval(timerRef.current);
             timerRef.current = null;
        }
    };
  }, [currentIndex, appState, speakWord, testWords, timeLimit, flashcardPhase]);


  const handleSelfCheck = useCallback((isCorrect) => {
    const currentWord = testWords[currentIndex];
    if (!currentWord) return;

    if (!isCorrect) {
        addWordToMistakeList(currentWord);
    }

    // --- 変更点: 復習モードのサドンデス機能 ---
    if (isReviewMode && !isCorrect) {
        alert("【復習モード】不正解！最初からやり直しです。（出題順をシャッフルします）");
        setResults([]);
        setCurrentIndex(0);
        setFlashcardPhase('question');
        
        // 変更: 設定に関わらず常にシャッフルしてリトライ
        setTestWords(prev => shuffleArray([...prev]));
        
        return;
    }
    // ---------------------------------------

    const result = {
        wordId: currentWord.id,
        word: currentWord.word,
        correctMeaning: currentWord.meaning,
        pronunciation: currentWord.pronunciation,
        transcript: '自己採点',
        isCorrect: isCorrect,
        status: isCorrect ? 'correct' : 'incorrect',
        datasetId: currentWord.datasetId
    };

    setResults(prev => [...prev, result]);

    if (currentIndex < testWords.length - 1) {
        setCurrentIndex(idx => idx + 1);
        setFlashcardPhase('question');
    } else {
        setAppState('result');
    }
  }, [testWords, currentIndex, isReviewMode, isRandom, addWordToMistakeList]);

  const handleToggleCorrect = (index) => {
    setResults(prev => {
        const newResults = [...prev];
        const target = newResults[index];
        const newIsCorrect = !target.isCorrect;
        
        newResults[index] = {
            ...target,
            isCorrect: newIsCorrect,
            status: newIsCorrect ? 'correct' : 'incorrect',
            overridden: newIsCorrect
        };
        return newResults;
    });
  };

  // --- キーボード操作の実装 ---
  useEffect(() => {
    const handleKeyDown = (e) => {
      if (appState === 'home') {
        if (e.key === 'Enter') {
          e.preventDefault();
          startTest();
        }
      } else if (appState === 'test') {
        if (flashcardPhase === 'question') {
          // Space or Enter to show answer
          if (e.code === 'Space' || e.key === 'Enter' || e.key === 'ArrowDown') {
            e.preventDefault(); // Prevent scroll
            if (shouldEnforceVoiceTrigger && !voiceTriggerSatisfied) {
              return;
            }
            setFlashcardPhase('answer');
          }
        } else if (flashcardPhase === 'answer') {
          // ArrowRight/Left for Yes/No
          if (e.key === 'ArrowRight' || e.key === 'y') {
            e.preventDefault();
            handleSelfCheck(true);
          } else if (e.key === 'ArrowLeft' || e.key === 'n') {
            e.preventDefault();
            handleSelfCheck(false);
          }
        }
      } else if (appState === 'result') {
        // Result画面でのキー操作
        if (e.key === 'Enter') {
             e.preventDefault();
             goHome();
        }
        // 'R'キーで復習スタートできるようにしても良いかも
      }
    };

    window.addEventListener('keydown', handleKeyDown);
    return () => window.removeEventListener('keydown', handleKeyDown);
  }, [appState, flashcardPhase, startTest, handleSelfCheck, goHome, shouldEnforceVoiceTrigger, voiceTriggerSatisfied]);


  const handleDownloadPDF = () => {
    const wrongAnswers = results.filter(r => !r.isCorrect);

    const htmlContent = `
      <!DOCTYPE html>
      <html lang="ja">
      <head>
        <meta charset="UTF-8">
        <title>英単語テスト 復習リスト</title>
        <style>
          body { font-family: "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif; padding: 40px; color: #333; }
          h1 { border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
          .meta { text-align: right; margin-bottom: 30px; font-size: 0.9em; color: #666; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
          th, td { border: 1px solid #999; padding: 12px; text-align: left; }
          th { background-color: #f0f0f0; width: 10%; }
          .col-word { width: 25%; font-weight: bold; font-size: 1.2em; }
          .col-pron { width: 15%; font-size: 0.9em; color: #555; }
          .col-check { width: 10%; text-align: center; }
          .check-box { display: inline-block; width: 15px; height: 15px; border: 1px solid #333; }
          @media print {
            .no-print { display: none; }
            body { padding: 0; }
          }
        </style>
      </head>
      <body>
        <h1>英単語テスト 復習リスト</h1>
        <div class="meta">実施日: ${new Date().toLocaleDateString()}</div>
        ${wrongAnswers.length > 0 ? `
          <table>
            <thead>
              <tr>
                <th>No.</th>
                <th>英単語</th>
                <th>読み方</th>
                <th>意味</th>
                <th class="col-check">確認</th>
              </tr>
            </thead>
            <tbody>
              ${wrongAnswers.map(res => `
                <tr>
                  <td>${res.wordId}</td>
                  <td class="col-word">${res.word}</td>
                  <td class="col-pron">${res.pronunciation}</td>
                  <td>${res.correctMeaning}</td>
                  <td class="col-check"><span class="check-box"></span></td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        ` : `<p style="text-align:center; font-size: 1.2em; margin-top: 50px;">全問正解です！素晴らしい！</p>`}
        
        <div class="no-print" style="text-align: center; margin-top: 30px;">
          <p style="font-size: 14px; color: #333; margin-bottom: 15px; font-weight: bold;">
            このページを「PDFとして保存」してください
          </p>
          <button onclick="window.print()" style="padding: 12px 24px; font-size: 16px; cursor: pointer; background: #333; color: #fff; border: none; border-radius: 6px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
            印刷 / PDF保存画面を開く
          </button>
        </div>
        <script>
          setTimeout(() => {
            window.print();
          }, 800);
        </script>
      </body>
      </html>
    `;

    const blob = new Blob([htmlContent], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    window.open(url, '_blank');
  };

  // ==========================================
  // UI Render
  // ==========================================

  if (appState === 'home') {
    return (
      <div className="min-h-screen bg-slate-50 flex flex-col items-center justify-center p-4 text-slate-800 font-sans">
        <div className="w-full max-w-md bg-white rounded-2xl shadow-xl p-8 text-center">
          <div className="mb-6 flex justify-center">
            <div className="bg-indigo-100 p-4 rounded-full">
              <BookOpen className="w-10 h-10 text-indigo-600" />
            </div>
          </div>
          <h1 className="text-2xl font-bold mb-2">英単語 暗記カード</h1>
          <p className="text-slate-500 mb-8 text-sm">表示される単語の意味を答えよう！</p>

          <div className="bg-slate-100 rounded-lg p-6 mb-8 text-left space-y-6">
            
            {/* 単語帳選択 */}
            <div>
              <div className="flex items-center gap-2 mb-2 text-slate-700 font-semibold"><Library className="w-5 h-5" /><span>単語帳を選択</span></div>
              <select 
                value={selectedDatasetId}
                onChange={(e) => setSelectedDatasetId(e.target.value)}
                className="w-full p-3 border rounded-lg bg-white font-bold text-slate-800 shadow-sm focus:ring-2 focus:ring-indigo-500 outline-none"
              >
                {Object.values(DATA_SETS).map(dataset => (
                  <option key={dataset.id} value={dataset.id}>{dataset.title}</option>
                ))}
              </select>
            </div>

            {/* マイクモード */}
            <div className="bg-white rounded-lg border border-slate-200 p-4 flex items-center justify-between gap-3">
              <div>
                <div className="flex items-center gap-2 text-slate-700 font-semibold">
                  {micModeEnabled ? <Mic className="w-4 h-4 text-indigo-600" /> : <MicOff className="w-4 h-4 text-slate-400" />}
                  <span>マイクモード</span>
                </div>
                <p className="text-xs text-slate-500 mt-1">
                  {micModeEnabled ? '声を出すと「答えを見る」ボタンが解放されます' : 'OFFにするとボタンは常に利用できます'}
                </p>
              </div>
              <button
                type="button"
                onClick={() => setMicModeEnabled(prev => !prev)}
                className={`relative inline-flex h-8 w-16 items-center rounded-full transition-colors ${micModeEnabled ? 'bg-indigo-600' : 'bg-slate-300'}`}
                aria-pressed={micModeEnabled}
              >
                <span className={`inline-block h-6 w-6 transform rounded-full bg-white shadow transition ${micModeEnabled ? 'translate-x-8' : 'translate-x-1'}`}></span>
              </button>
            </div>

            {/* 出題範囲 */}
            <div>
              <div className="flex items-center gap-2 mb-4 text-slate-700 font-semibold"><Settings className="w-5 h-5" /><span>出題範囲 (No.1 - {wordList.length})</span></div>
              <div className="flex items-center gap-4 justify-between">
                <div className="flex-1"><label className="block text-xs text-slate-500 mb-1">Start</label><input type="number" value={rangeStart} onChange={(e) => setRangeStart(Number(e.target.value))} className="w-full p-2 border rounded text-center text-lg font-bold"/></div>
                <span className="text-slate-400 px-2">〜</span>
                <div className="flex-1"><label className="block text-xs text-slate-500 mb-1">End</label><input type="number" value={rangeEnd} onChange={(e) => setRangeEnd(Number(e.target.value))} className="w-full p-2 border rounded text-center text-lg font-bold"/></div>
              </div>
            </div>

            {/* 制限時間 */}
            <div>
            <div className="flex items-center gap-2 mb-2 text-slate-700 font-semibold"><Clock className="w-5 h-5" /><span>制限時間 (秒)</span></div>
            <div className="flex items-center justify-between bg-white p-1 rounded-lg border border-slate-200">
                {[5, 10, 15, 20].map((sec) => (
                <button key={sec} onClick={() => setTimeLimit(sec)} className={`flex-1 py-2 rounded-md text-sm font-bold transition-all ${timeLimit === sec ? 'bg-indigo-100 text-indigo-700 shadow-sm' : 'text-slate-400 hover:text-slate-600'}`}>{sec}秒</button>
                ))}
            </div>
            </div>

            {/* 設定スイッチ群 */}
            <div className="space-y-3">
               {/* 出題順 */}
               <div className="flex items-center justify-between bg-white p-2 rounded-lg border border-slate-200">
                 <button onClick={() => setIsRandom(false)} className={`flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-sm font-bold transition-all ${!isRandom ? 'bg-indigo-100 text-indigo-700 shadow-sm' : 'text-slate-400 hover:text-slate-600'}`}><ListOrdered className="w-4 h-4" /> 順番通り</button>
                 <button onClick={() => setIsRandom(true)} className={`flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-sm font-bold transition-all ${isRandom ? 'bg-indigo-100 text-indigo-700 shadow-sm' : 'text-slate-400 hover:text-slate-600'}`}><Shuffle className="w-4 h-4" /> ランダム</button>
               </div>
            </div>

          </div>

          <button onClick={startTest} className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-xl shadow-lg transition-all transform active:scale-95 flex items-center justify-center gap-2">
            <Play className="w-5 h-5" /> テストを開始 <span className="text-indigo-200 text-xs font-normal ml-2">[Enter]</span>
          </button>

          <div className="mt-6 bg-slate-100 rounded-xl p-5 text-left border border-slate-200">
            <div className="flex items-start justify-between gap-4">
              <div>
                <div className="flex items-center gap-2 text-slate-600 font-semibold mb-1">
                  <AlertCircle className="w-4 h-4" /> 苦手単語リスト
                </div>
                <p className="text-3xl font-black text-slate-800">
                  {mistakeWords.length}
                  <span className="text-base font-medium text-slate-500 ml-1">単語</span>
                </p>
                <p className="text-xs text-slate-500 mt-1">テストで間違えた単語が自動追加されます</p>
              </div>
              <button
                onClick={startMistakeDrill}
                disabled={mistakeWords.length === 0}
                className={`px-4 py-2 rounded-lg text-sm font-bold transition-all flex flex-col items-center gap-1 ${mistakeWords.length === 0 ? 'bg-white text-slate-300 border border-dashed border-slate-200 cursor-not-allowed' : 'bg-amber-100 text-amber-700 border border-amber-200 hover:bg-amber-200'}`}
              >
                <Repeat className="w-4 h-4" />
                苦手を練習
              </button>
            </div>
            {mistakeWords.length > 0 && (
              <div className="mt-3 text-xs text-slate-500">
                <span className="font-bold text-slate-600">最近追加:</span>
                <div className="mt-2 flex flex-wrap gap-2">
                  {mistakeWords.slice(-5).map(word => (
                    <span key={`${word.datasetId}-${word.id}`} className="bg-white px-2 py-1 rounded-full border border-slate-200 text-slate-600 font-semibold">
                      {word.word}
                    </span>
                  ))}
                </div>
              </div>
            )}
          </div>
        </div>
      </div>
    );
  }

  if (appState === 'test') {
    const currentWord = testWords[currentIndex];
    if (!currentWord) return null;
    const progressPercent = ((currentIndex + 1) / testWords.length) * 100;
    const volumeProgress = Math.min(1, volumeLevel * VOLUME_VISUAL_MULTIPLIER);
    const thresholdProgress = Math.min(1, VOICE_THRESHOLD * VOLUME_VISUAL_MULTIPLIER);
    const isVolumeEnough = volumeLevel >= VOICE_THRESHOLD;
    const answerButtonDisabled = flashcardPhase === 'question' && shouldEnforceVoiceTrigger && !voiceTriggerSatisfied;
    const micStatusText = (() => {
      if (!micModeEnabled) return 'OFF';
      if (micStatus === 'requesting') return 'マイク許可待ち…';
      if (micStatus === 'listening') return voiceTriggerSatisfied ? 'Good!' : '声を出してください';
      if (micStatus === 'error') return 'マイクを利用できません';
      if (micStatus === 'unsupported') return '未対応デバイスです';
      return 'マイク待機中';
    })();

    return (
      <div className={`min-h-screen text-white flex flex-col items-center p-4 relative overflow-hidden transition-colors duration-500 ${isReviewMode ? 'bg-slate-800' : isMistakeMode ? 'bg-slate-800' : 'bg-slate-900'}`}>
        {isReviewMode && (
            <div className="absolute top-0 w-full bg-red-500/10 h-full pointer-events-none z-0"></div>
        )}
        {isMistakeMode && !isReviewMode && (
            <div className="absolute top-0 w-full bg-amber-400/10 h-full pointer-events-none z-0"></div>
        )}
        
        <div className="w-full max-w-md absolute top-0 left-0 h-2 bg-slate-800 z-20">
          <div className={`h-full transition-all duration-500 ease-out ${isReviewMode ? 'bg-red-500' : isMistakeMode ? 'bg-amber-400' : 'bg-green-500'}`} style={{ width: `${progressPercent}%` }} />
        </div>

        <div className="w-full max-w-md mt-6 flex justify-between items-center text-sm text-slate-400 z-10">
          <span className="font-mono text-white font-bold">
            {isReviewMode && <span className="text-red-400 mr-2 font-bold animate-pulse">復習中 (全問正解まで継続)</span>}
            {!isReviewMode && isMistakeMode && <span className="text-amber-300 mr-2 font-bold animate-pulse">苦手単語モード</span>}
            {currentIndex + 1} <span className="text-slate-600">/</span> {testWords.length}
          </span>
          <button onClick={goHome} className="text-slate-500 hover:text-white">中断</button>
        </div>

        <div className="w-full max-w-md mt-4 z-10">
          <button
            type="button"
            onClick={() => setMicModeEnabled(prev => !prev)}
            aria-pressed={micModeEnabled}
            className={`w-full flex items-center justify-between px-4 py-3 rounded-2xl border text-[11px] font-bold tracking-widest uppercase transition ${micModeEnabled ? 'bg-emerald-500/10 border-emerald-300/40 text-emerald-100' : 'bg-slate-900/60 border-white/10 text-slate-300 hover:text-white'}`}
          >
            <span className="flex items-center gap-2">
              {micModeEnabled ? <Mic className="w-4 h-4" /> : <MicOff className="w-4 h-4" />}
              VOICE TRIGGER
            </span>
            <span>{micModeEnabled ? 'ON' : 'OFF'}</span>
          </button>
          <div className={`text-[11px] mt-2 text-center ${micModeEnabled ? (voiceTriggerSatisfied ? 'text-emerald-200' : 'text-slate-300') : 'text-slate-400'}`}>
            {micModeEnabled ? (micStatus === 'error' || micStatus === 'unsupported' ? 'マイクを検知できません。OFFモードをご利用ください。' : '声を出すと「答えを見る」ボタンが解放されます。') : 'OFFでは声を出さずにボタンを押せます。'}
          </div>
        </div>

        {/* --- 共通: 単語表示エリア --- */}
        <div className="flex-1 w-full max-w-md flex flex-col justify-center items-center relative z-10">
          <div className="mb-10 relative">
             <div className={`w-24 h-24 rounded-full flex items-center justify-center border-4 text-3xl font-bold transition-colors ${timeLeft <= 3 ? 'border-red-500 text-red-500' : (isReviewMode ? 'border-red-400 text-red-400' : isMistakeMode ? 'border-amber-400 text-amber-200' : 'border-indigo-500 text-indigo-400')}`}>
                {flashcardPhase === 'answer' ? <Layers className="w-10 h-10" /> : timeLeft}
             </div>
          </div>

          <div className="w-full bg-white text-slate-900 rounded-3xl p-8 text-center shadow-2xl mb-8 min-h-[220px] flex flex-col justify-center relative">
            <span className="text-sm text-slate-400 font-bold tracking-widest uppercase mb-2">No.{currentWord.id}</span>
            <h2 className="text-5xl font-extrabold tracking-tight break-words mb-4 leading-tight">{currentWord.word}</h2>
            <button onClick={() => speakWord(currentWord.word)} className="absolute top-4 right-4 p-2 text-indigo-200 hover:text-indigo-600 hover:bg-indigo-50 rounded-full transition-colors" title="もう一度聞く"><Volume2 className="w-6 h-6" /></button>
            
            {flashcardPhase === 'answer' && (
                <div className="mt-4 pt-4 border-t border-slate-100 animate-in fade-in slide-in-from-bottom-4">
                    {currentWord.pronunciation && <p className="text-lg text-slate-500 mb-1">({currentWord.pronunciation})</p>}
                    <p className="text-xl font-bold text-indigo-600">{currentWord.meaning}</p>
                </div>
            )}
          </div>
        </div>

        {micModeEnabled && (
          <div className="w-full max-w-md mb-6 z-10">
            <div className="bg-white/5 border border-white/10 rounded-2xl p-4 backdrop-blur-sm">
              <div className="flex items-center justify-between text-[11px] uppercase tracking-widest text-slate-200 font-semibold mb-2">
                <div className="flex items-center gap-2">
                  <Activity className="w-4 h-4 text-indigo-200" />
                  VOICE LEVEL
                </div>
                <span className={`${voiceTriggerSatisfied ? 'text-emerald-200' : 'text-slate-300'}`}>{micStatusText}</span>
              </div>
              <div className="relative h-3 rounded-full bg-slate-900 overflow-hidden">
                <div className={`absolute inset-y-0 left-0 ${voiceTriggerSatisfied ? 'bg-emerald-400' : 'bg-indigo-400'} transition-all duration-200`} style={{ width: `${volumeProgress * 100}%` }}></div>
                <div className="absolute inset-y-0" style={{ left: `${thresholdProgress * 100}%` }}>
                  <div className="w-0.5 h-full bg-white/60"></div>
                </div>
              </div>
              <div className="flex items-center justify-between text-[11px] text-slate-300 mt-2">
                <span>音量: {Math.round(volumeProgress * 100)}%</span>
                {isVolumeEnough ? (
                  <span className="flex items-center gap-1 text-emerald-200 font-bold">
                    <CheckCircle className="w-3 h-3" /> Good!
                  </span>
                ) : (
                  <span className="flex items-center gap-1 text-slate-400">
                    <Layers className="w-3 h-3" />
                    閾値ライン
                  </span>
                )}
              </div>
              {micStatus === 'error' && (
                <p className="text-[11px] text-amber-200 mt-2">マイクを許可できない場合は、ホーム設定でマイクモードをOFFにしてください。</p>
              )}
            </div>
          </div>
        )}

        {/* --- 操作ボタン --- */}
        <div className="w-full max-w-md mb-8 z-10">
            {flashcardPhase === 'question' ? (
                <button
                  onClick={() => setFlashcardPhase('answer')}
                  disabled={answerButtonDisabled}
                  className={`w-full text-white font-bold py-4 rounded-xl shadow-lg transition-all active:scale-95 text-lg flex items-center justify-center gap-2 ${isReviewMode ? 'bg-red-600 hover:bg-red-700 shadow-red-900/50' : isMistakeMode ? 'bg-amber-500 hover:bg-amber-600 shadow-amber-900/30 text-slate-900' : 'bg-indigo-600 hover:bg-indigo-700 shadow-indigo-900/50'} ${answerButtonDisabled ? 'opacity-60 cursor-not-allowed' : ''}`}
                >
                  <Eye className="w-5 h-5" /> 答えを見る <span className={`${isReviewMode ? 'text-red-300' : isMistakeMode ? 'text-amber-100' : 'text-indigo-300'} text-xs font-normal ml-2`}>[Space]</span>
                </button>
            ) : (
                <div className="flex gap-3">
                    <button onClick={() => handleSelfCheck(false)} className="flex-1 bg-red-500 hover:bg-red-600 text-white font-bold py-4 rounded-xl shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2">
                      <ThumbsDown className="w-5 h-5" /> わからない <span className="text-red-200 text-xs font-normal ml-1">[←]</span>
                    </button>
                    <button onClick={() => handleSelfCheck(true)} className="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2">
                      <ThumbsUp className="w-5 h-5" /> わかった <span className="text-green-200 text-xs font-normal ml-1">[→]</span>
                    </button>
                </div>
            )}
            {isMistakeMode && (
                <button onClick={handleRemoveCurrentMistakeWord} className="mt-3 w-full border border-amber-300 text-amber-200 hover:bg-white/10 font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2">
                  <XCircle className="w-4 h-4" /> この単語を苦手リストから外す
                </button>
            )}
        </div>
      </div>
    );
  }

  if (appState === 'result') {
    // 手動修正も反映した正しい正解数を計算
    const actualCorrectCount = results.filter(r => r.isCorrect).length;
    const score = Math.round((actualCorrectCount / results.length) * 100) || 0;
    const wrongAnswers = results.filter(r => !r.isCorrect);

    if (isMistakeMode) {
        const remaining = mistakeWords.length;
        return (
          <div className="min-h-screen bg-amber-50 flex flex-col items-center p-4 font-sans">
            <div className="w-full max-w-md bg-white rounded-2xl shadow-xl p-8 text-center">
              <div className="w-14 h-14 rounded-full bg-amber-100 text-amber-600 flex items-center justify-center mx-auto mb-4">
                <Layers className="w-7 h-7" />
              </div>
              <h2 className="text-2xl font-bold text-slate-800 mb-2">苦手単語フラッシュカード</h2>
              <p className="text-slate-500 text-sm mb-6">今回学習した単語: {results.length}語</p>

              <div className="bg-slate-100 rounded-xl p-4 text-left mb-6">
                <p className="text-sm text-slate-500">リストに残っている単語</p>
                <p className="text-4xl font-black text-slate-800 mt-1">{remaining}<span className="text-base text-slate-500 font-medium ml-1">語</span></p>
                {remaining === 0 && <p className="text-sm text-amber-500 mt-1 font-semibold">全て外せました！</p>}
              </div>

              {remaining > 0 ? (
                <button onClick={startMistakeDrill} className="w-full bg-amber-500 hover:bg-amber-600 text-white font-bold py-4 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2 mb-3">
                  <Repeat className="w-5 h-5" /> 残りを続けて練習
                </button>
              ) : (
                <div className="mb-3 text-sm text-slate-500">リストは空です。通常のテストに戻りましょう！</div>
              )}

              <button onClick={goHome} className="w-full border border-slate-200 text-slate-600 font-bold py-4 rounded-xl hover:bg-slate-50 flex items-center justify-center gap-2">
                <BookOpen className="w-5 h-5" /> ホームに戻る
              </button>

              {remaining > 0 && (
                <div className="mt-6 text-left">
                  <div className="text-xs font-bold text-slate-500 mb-2">現在のリスト</div>
                  <div className="flex flex-wrap gap-2 max-h-40 overflow-y-auto">
                    {mistakeWords.map(word => (
                      <span key={`${word.datasetId}-${word.id}`} className="px-2 py-1 rounded-full bg-slate-100 text-slate-600 text-xs font-semibold border border-slate-200">
                        {word.word}
                      </span>
                    ))}
                  </div>
                </div>
              )}
            </div>
          </div>
        );
    }

    // 復習モードで全問正解した場合
    if (isReviewMode && wrongAnswers.length === 0) {
         return (
            <div className="min-h-screen bg-slate-900 flex flex-col items-center p-4 font-sans text-white">
                 <div className="w-full max-w-md flex-1 flex flex-col justify-center items-center pb-10">
                    <div className="bg-yellow-500/20 p-6 rounded-full mb-6 animate-bounce">
                        <Trophy className="w-16 h-16 text-yellow-500" />
                    </div>
                    <h2 className="text-3xl font-bold mb-2 text-center text-yellow-400">復習完了！</h2>
                    <p className="text-slate-300 mb-8 text-center">
                        おめでとうございます！<br/>
                        苦手な {results.length} 単語をすべて克服しました。
                    </p>

                    <button onClick={goHome} className="w-full max-w-sm bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-5 rounded-2xl shadow-lg shadow-indigo-900/50 text-xl flex items-center justify-center gap-2 transition-all transform active:scale-95">
                        <BookOpen className="w-6 h-6" /> ホームに戻る
                    </button>
                 </div>
            </div>
        );
    }

    // 通常のリザルト画面
    return (
      <div className="min-h-screen bg-slate-50 flex flex-col items-center p-4 font-sans">
        <div className="w-full max-w-md pb-32 no-print">
          <div className="bg-white rounded-2xl shadow-lg p-6 text-center mb-6">
            {wrongAnswers.length === 0 ? (
                 <Trophy className="w-12 h-12 text-yellow-500 mx-auto mb-2 animate-bounce" />
            ) : (
                 <div className="w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-2">
                    <CheckCircle className="w-8 h-8 text-slate-400" />
                 </div>
            )}
            
            <h2 className="text-lg text-slate-500 font-bold">SCORE</h2>
            <div className="text-6xl font-black text-slate-800 my-2">{score}<span className="text-2xl text-slate-400 font-normal">pts</span></div>
            <div className="text-slate-400 font-medium">{actualCorrectCount} / {results.length} 正解</div>

            {wrongAnswers.length === 0 && (
                <div className="mt-4 text-indigo-600 font-bold bg-indigo-50 py-2 px-4 rounded-full inline-block animate-pulse">
                    Perfect!! 🎉
                </div>
            )}
          </div>
          
          {/* 復習・保存ボタンエリア */}
          {wrongAnswers.length > 0 && (
             <div className="mb-8 space-y-3">
               <div className="text-center text-sm font-bold text-slate-600 mb-1">間違えた単語: {wrongAnswers.length}問</div>
               
               {/* 復習開始ボタン */}
               <button onClick={startReview} className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-4 rounded-xl shadow-lg shadow-indigo-200 flex items-center justify-center gap-2 transition-all transform active:scale-95">
                  <Sparkles className="w-5 h-5 animate-pulse" /> 徹底復習する (全問正解まで)
               </button>
               
               <button onClick={handleDownloadPDF} className="w-full bg-white border border-slate-300 hover:bg-slate-50 text-slate-600 font-bold py-3 px-4 rounded-xl flex items-center justify-center gap-2 transition-all">
                  <Download className="w-5 h-5" /> 復習リストをPDF保存
               </button>
             </div>
          )}

          <div className="text-xs text-center text-slate-400 mb-4">※「修正」ボタンで正解に変更できます</div>

          <h3 className="text-sm font-bold text-slate-500 mb-2 ml-2">全回答 (確認・修正)</h3>
          <div className="bg-white rounded-xl shadow-sm overflow-hidden">
            {results.map((res, idx) => (
              <div key={idx} className={`p-3 border-b border-slate-100 last:border-0 flex items-center gap-3 ${!res.isCorrect ? 'bg-red-50/50' : ''}`}>
                <div className="flex-shrink-0">{res.isCorrect ? <CheckCircle className={`w-6 h-6 ${res.overridden ? 'text-indigo-500' : 'text-green-500'}`} /> : <XCircle className="w-6 h-6 text-red-400" />}</div>
                <div className="flex-1 min-w-0">
                  <div className="flex justify-between items-baseline">
                    <span className="font-bold text-slate-800">{res.word}</span>
                    <span className="text-xs text-slate-400">No.{res.wordId}</span>
                  </div>
                  <div className="text-xs text-slate-400 truncate">意味: {res.correctMeaning}</div>
                  {res.overridden && <div className="text-[10px] text-indigo-500 font-bold mt-1">手動修正済み</div>}
                </div>
                <button onClick={() => handleToggleCorrect(idx)} className={`p-2 rounded-lg text-xs font-bold transition-colors flex flex-col items-center gap-1 min-w-[60px] ${res.isCorrect ? 'bg-slate-100 text-slate-400 hover:bg-slate-200' : 'bg-indigo-100 text-indigo-600 hover:bg-indigo-200'}`}><Edit2 className="w-4 h-4" /> {res.isCorrect ? '戻す' : '修正'}</button>
              </div>
            ))}
          </div>
        </div>

        <div className="fixed bottom-0 left-0 w-full bg-white border-t p-4 shadow-lg-top flex justify-center z-50 no-print">
          <div className="w-full max-w-md">
            <button onClick={goHome} className="w-full bg-slate-800 hover:bg-slate-900 text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 transition-colors">
              <RotateCcw className="w-4 h-4" /> ホームに戻る <span className="text-slate-400 text-xs font-normal ml-2">[Enter]</span>
            </button>
          </div>
        </div>
      </div>
    );
  }
  return null;
}
